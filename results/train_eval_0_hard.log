2025-08-13 12:38:24,632 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_enhanced_hard_0.json'}
2025-08-13 12:38:24,632 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-13 12:38:24,665 [INFO] Using device: cuda
2025-08-13 12:41:10,647 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 12:41:10,897 [INFO] Model: enhanced with 584200 params
2025-08-13 12:41:23,053 [INFO] Epoch 1/100 - Val Loss: 1.0836
2025-08-13 12:41:23,463 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 12:41:26,820 [INFO] Epoch 2/100 - Val Loss: 0.9480
2025-08-13 12:41:27,191 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 12:41:30,521 [INFO] Epoch 3/100 - Val Loss: 0.7279
2025-08-13 12:41:30,923 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 12:41:34,280 [INFO] Epoch 4/100 - Val Loss: 0.6736
2025-08-13 12:41:34,711 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 12:41:37,731 [INFO] Epoch 5/100 - Val Loss: 2.2449
2025-08-13 12:41:38,110 [INFO] Epoch 5/100 - Train Loss: 1.1909, Val Loss: 2.2449, Val macro_f1: 0.1825, Avg Reg Loss: 0.349969
2025-08-13 12:41:41,419 [INFO] Epoch 6/100 - Val Loss: 0.8908
2025-08-13 12:41:45,172 [INFO] Epoch 7/100 - Val Loss: 0.7700
2025-08-13 12:41:48,892 [INFO] Epoch 8/100 - Val Loss: 0.8015
2025-08-13 12:41:52,490 [INFO] Epoch 9/100 - Val Loss: 1.3964
2025-08-13 12:41:56,137 [INFO] Epoch 10/100 - Val Loss: 1.2525
2025-08-13 12:41:56,501 [INFO] Epoch 10/100 - Train Loss: 1.7305, Val Loss: 1.2525, Val macro_f1: 0.4722, Avg Reg Loss: 0.239636
2025-08-13 12:41:59,853 [INFO] Epoch 11/100 - Val Loss: 0.9756
2025-08-13 12:42:03,512 [INFO] Epoch 12/100 - Val Loss: 0.9728
2025-08-13 12:42:06,994 [INFO] Epoch 13/100 - Val Loss: 0.8321
2025-08-13 12:42:10,624 [INFO] Epoch 14/100 - Val Loss: 0.7916
2025-08-13 12:42:11,011 [INFO] Early stopping at epoch 14
2025-08-13 12:42:11,377 [INFO] Collected test logits and targets
2025-08-13 12:42:11,492 [INFO] Calibration: T=0.7130, Details={'temperature': 0.7129946351051331, 'best_nll': 0.736086368560791, 'method': 'logspace'}
2025-08-13 12:42:11,523 [INFO] Saved full results to results\paperA_enhanced_hard_0.json
2025-08-13 12:42:16,300 [INFO] Starting training with args: {'model': 'bilstm', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_bilstm_hard_0.json'}
2025-08-13 12:42:16,300 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-13 12:42:16,330 [INFO] Using device: cuda
2025-08-13 12:44:57,577 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 12:44:57,578 [ERROR] Error: Unknown model bilstm
Traceback (most recent call last):
  File "E:\paperA\paperA\src\train_eval.py", line 358, in main
    model = build_model(args.model, args.F, args.num_classes)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\paperA\paperA\src\models.py", line 214, in build_model
    raise ValueError(f"Unknown model {name}")
ValueError: Unknown model bilstm
2025-08-13 12:45:01,829 [INFO] Starting training with args: {'model': 'cnn', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_cnn_hard_0.json'}
2025-08-13 12:45:01,830 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-13 12:45:01,860 [INFO] Using device: cuda
2025-08-13 12:47:43,899 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 12:47:43,900 [ERROR] Error: Unknown model cnn
Traceback (most recent call last):
  File "E:\paperA\paperA\src\train_eval.py", line 358, in main
    model = build_model(args.model, args.F, args.num_classes)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\paperA\paperA\src\models.py", line 214, in build_model
    raise ValueError(f"Unknown model {name}")
ValueError: Unknown model cnn
2025-08-13 13:08:48,317 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_enhanced_hard_0.json'}
2025-08-13 13:08:48,317 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-13 13:08:48,344 [INFO] Using device: cuda
2025-08-13 13:11:32,836 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 13:11:32,950 [INFO] Model: enhanced with 1738120 params
2025-08-13 13:11:41,860 [INFO] Epoch 1/100 - Val Loss: 0.8002
2025-08-13 13:11:42,156 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:11:43,671 [INFO] Epoch 2/100 - Val Loss: 0.8290
2025-08-13 13:11:45,059 [INFO] Epoch 3/100 - Val Loss: 0.8237
2025-08-13 13:11:47,000 [INFO] Epoch 4/100 - Val Loss: 0.8406
2025-08-13 13:11:49,118 [INFO] Epoch 5/100 - Val Loss: 0.9066
2025-08-13 13:11:49,365 [INFO] Epoch 5/100 - Train Loss: 0.9427, Val Loss: 0.9066, Val macro_f1: 0.6897, Avg Reg Loss: 0.365236
2025-08-13 13:11:51,525 [INFO] Epoch 6/100 - Val Loss: 0.9483
2025-08-13 13:11:53,796 [INFO] Epoch 7/100 - Val Loss: 0.9526
2025-08-13 13:11:56,361 [INFO] Epoch 8/100 - Val Loss: 1.0270
2025-08-13 13:11:58,458 [INFO] Epoch 9/100 - Val Loss: 0.9948
2025-08-13 13:12:00,054 [INFO] Epoch 10/100 - Val Loss: 1.0230
2025-08-13 13:12:00,292 [INFO] Epoch 10/100 - Train Loss: 0.6584, Val Loss: 1.0230, Val macro_f1: 0.6566, Avg Reg Loss: 0.393796
2025-08-13 13:12:01,965 [INFO] Epoch 11/100 - Val Loss: 1.0433
2025-08-13 13:12:02,212 [INFO] Early stopping at epoch 11
2025-08-13 13:12:02,469 [INFO] Collected test logits and targets
2025-08-13 13:12:02,573 [INFO] Calibration: T=1.0013, Details={'temperature': 1.0012959241867065, 'best_nll': 1.033935785293579, 'method': 'logspace'}
2025-08-13 13:12:02,609 [INFO] Saved full results to results\paperA_enhanced_hard_0.json
2025-08-13 13:12:07,459 [INFO] Starting training with args: {'model': 'bilstm', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_bilstm_hard_0.json'}
2025-08-13 13:12:07,459 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-13 13:12:07,487 [INFO] Using device: cuda
2025-08-13 13:14:57,431 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 13:14:57,553 [INFO] Model: bilstm with 583688 params
2025-08-13 13:15:09,189 [INFO] Epoch 1/100 - Val Loss: 1.0308
2025-08-13 13:15:09,592 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:15:12,830 [INFO] Epoch 2/100 - Val Loss: 0.9170
2025-08-13 13:15:13,218 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:15:16,373 [INFO] Epoch 3/100 - Val Loss: 0.9260
2025-08-13 13:15:19,956 [INFO] Epoch 4/100 - Val Loss: 0.8618
2025-08-13 13:15:20,337 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:15:23,558 [INFO] Epoch 5/100 - Val Loss: 0.8667
2025-08-13 13:15:23,945 [INFO] Epoch 5/100 - Train Loss: 1.1957, Val Loss: 0.8667, Val macro_f1: 0.6419, Avg Reg Loss: 0.343609
2025-08-13 13:15:27,174 [INFO] Epoch 6/100 - Val Loss: 0.8052
2025-08-13 13:15:27,564 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:15:30,725 [INFO] Epoch 7/100 - Val Loss: 0.8195
2025-08-13 13:15:34,348 [INFO] Epoch 8/100 - Val Loss: 0.8404
2025-08-13 13:15:37,975 [INFO] Epoch 9/100 - Val Loss: 0.7819
2025-08-13 13:15:38,366 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:15:41,798 [INFO] Epoch 10/100 - Val Loss: 0.8705
2025-08-13 13:15:42,179 [INFO] Epoch 10/100 - Train Loss: 1.1778, Val Loss: 0.8705, Val macro_f1: 0.6765, Avg Reg Loss: 0.338348
2025-08-13 13:15:45,348 [INFO] Epoch 11/100 - Val Loss: 0.7926
2025-08-13 13:15:48,984 [INFO] Epoch 12/100 - Val Loss: 0.7789
2025-08-13 13:15:52,614 [INFO] Epoch 13/100 - Val Loss: 0.7693
2025-08-13 13:15:56,227 [INFO] Epoch 14/100 - Val Loss: 0.7513
2025-08-13 13:15:56,624 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:15:59,806 [INFO] Epoch 15/100 - Val Loss: 0.8804
2025-08-13 13:16:00,187 [INFO] Epoch 15/100 - Train Loss: 1.1169, Val Loss: 0.8804, Val macro_f1: 0.6563, Avg Reg Loss: 0.341960
2025-08-13 13:16:03,431 [INFO] Epoch 16/100 - Val Loss: 0.6423
2025-08-13 13:16:03,817 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:16:07,067 [INFO] Epoch 17/100 - Val Loss: 0.7199
2025-08-13 13:16:10,684 [INFO] Epoch 18/100 - Val Loss: 0.4762
2025-08-13 13:16:11,072 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:16:14,205 [INFO] Epoch 19/100 - Val Loss: 0.4799
2025-08-13 13:16:17,763 [INFO] Epoch 20/100 - Val Loss: 0.2874
2025-08-13 13:16:18,153 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:16:18,153 [INFO] Epoch 20/100 - Train Loss: 0.7621, Val Loss: 0.2874, Val macro_f1: 0.9323, Avg Reg Loss: 0.379755
2025-08-13 13:16:21,642 [INFO] Epoch 21/100 - Val Loss: 0.2779
2025-08-13 13:16:22,042 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:16:25,362 [INFO] Epoch 22/100 - Val Loss: 0.2999
2025-08-13 13:16:28,934 [INFO] Epoch 23/100 - Val Loss: 0.3199
2025-08-13 13:16:32,512 [INFO] Epoch 24/100 - Val Loss: 0.2353
2025-08-13 13:16:32,908 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:16:36,131 [INFO] Epoch 25/100 - Val Loss: 0.1755
2025-08-13 13:16:36,538 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:16:36,539 [INFO] Epoch 25/100 - Train Loss: 0.5808, Val Loss: 0.1755, Val macro_f1: 0.9794, Avg Reg Loss: 0.388922
2025-08-13 13:16:39,778 [INFO] Epoch 26/100 - Val Loss: 0.1887
2025-08-13 13:16:43,397 [INFO] Epoch 27/100 - Val Loss: 0.3075
2025-08-13 13:16:46,833 [INFO] Epoch 28/100 - Val Loss: 0.1620
2025-08-13 13:16:50,369 [INFO] Epoch 29/100 - Val Loss: 0.1385
2025-08-13 13:16:50,759 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:16:53,983 [INFO] Epoch 30/100 - Val Loss: 0.1342
2025-08-13 13:16:54,364 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:16:54,365 [INFO] Epoch 30/100 - Train Loss: 0.5193, Val Loss: 0.1342, Val macro_f1: 0.9890, Avg Reg Loss: 0.393113
2025-08-13 13:16:57,588 [INFO] Epoch 31/100 - Val Loss: 0.1550
2025-08-13 13:17:01,063 [INFO] Epoch 32/100 - Val Loss: 0.1339
2025-08-13 13:17:01,396 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:17:04,762 [INFO] Epoch 33/100 - Val Loss: 0.1498
2025-08-13 13:17:08,305 [INFO] Epoch 34/100 - Val Loss: 0.1600
2025-08-13 13:17:11,830 [INFO] Epoch 35/100 - Val Loss: 0.3327
2025-08-13 13:17:12,206 [INFO] Epoch 35/100 - Train Loss: 0.7693, Val Loss: 0.3327, Val macro_f1: 0.9254, Avg Reg Loss: 0.371390
2025-08-13 13:17:15,248 [INFO] Epoch 36/100 - Val Loss: 0.1700
2025-08-13 13:17:18,748 [INFO] Epoch 37/100 - Val Loss: 0.1603
2025-08-13 13:17:22,349 [INFO] Epoch 38/100 - Val Loss: 0.1232
2025-08-13 13:17:22,729 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:17:25,973 [INFO] Epoch 39/100 - Val Loss: 0.1252
2025-08-13 13:17:29,482 [INFO] Epoch 40/100 - Val Loss: 0.1188
2025-08-13 13:17:29,813 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:17:29,814 [INFO] Epoch 40/100 - Train Loss: 0.5084, Val Loss: 0.1188, Val macro_f1: 0.9926, Avg Reg Loss: 0.395097
2025-08-13 13:17:33,025 [INFO] Epoch 41/100 - Val Loss: 0.1194
2025-08-13 13:17:33,417 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:17:36,648 [INFO] Epoch 42/100 - Val Loss: 0.1288
2025-08-13 13:17:40,266 [INFO] Epoch 43/100 - Val Loss: 0.1183
2025-08-13 13:17:43,885 [INFO] Epoch 44/100 - Val Loss: 0.1141
2025-08-13 13:17:44,371 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:17:47,595 [INFO] Epoch 45/100 - Val Loss: 0.1324
2025-08-13 13:17:47,974 [INFO] Epoch 45/100 - Train Loss: 0.5150, Val Loss: 0.1324, Val macro_f1: 0.9920, Avg Reg Loss: 0.393013
2025-08-13 13:17:51,314 [INFO] Epoch 46/100 - Val Loss: 0.1399
2025-08-13 13:17:54,926 [INFO] Epoch 47/100 - Val Loss: 0.1081
2025-08-13 13:17:58,500 [INFO] Epoch 48/100 - Val Loss: 0.1158
2025-08-13 13:18:01,812 [INFO] Epoch 49/100 - Val Loss: 0.1284
2025-08-13 13:18:05,338 [INFO] Epoch 50/100 - Val Loss: 0.1175
2025-08-13 13:18:05,699 [INFO] Epoch 50/100 - Train Loss: 0.4966, Val Loss: 0.1175, Val macro_f1: 0.9926, Avg Reg Loss: 0.395167
2025-08-13 13:18:08,852 [INFO] Epoch 51/100 - Val Loss: 0.1200
2025-08-13 13:18:12,317 [INFO] Epoch 52/100 - Val Loss: 0.1194
2025-08-13 13:18:15,856 [INFO] Epoch 53/100 - Val Loss: 0.1071
2025-08-13 13:18:19,197 [INFO] Epoch 54/100 - Val Loss: 0.1111
2025-08-13 13:18:19,556 [INFO] Early stopping at epoch 54
2025-08-13 13:18:19,924 [INFO] Collected test logits and targets
2025-08-13 13:18:20,069 [INFO] Calibration: T=0.4981, Details={'temperature': 0.4980812072753906, 'best_nll': 0.018744032829999924, 'method': 'logspace'}
2025-08-13 13:18:20,103 [INFO] Saved full results to results\paperA_bilstm_hard_0.json
2025-08-13 13:18:24,772 [INFO] Starting training with args: {'model': 'cnn', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_cnn_hard_0.json'}
2025-08-13 13:18:24,772 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-13 13:18:24,800 [INFO] Using device: cuda
2025-08-13 13:21:20,397 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 13:21:20,540 [INFO] Model: cnn with 3427848 params
2025-08-13 13:21:33,303 [INFO] Epoch 1/100 - Val Loss: 0.4773
2025-08-13 13:21:33,708 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:21:37,062 [INFO] Epoch 2/100 - Val Loss: 0.2471
2025-08-13 13:21:37,445 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:21:40,818 [INFO] Epoch 3/100 - Val Loss: 0.1739
2025-08-13 13:21:41,229 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:21:44,610 [INFO] Epoch 4/100 - Val Loss: 0.1559
2025-08-13 13:21:44,917 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:21:48,235 [INFO] Epoch 5/100 - Val Loss: 0.1390
2025-08-13 13:21:48,639 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:21:48,640 [INFO] Epoch 5/100 - Train Loss: 0.5382, Val Loss: 0.1390, Val macro_f1: 0.9912, Avg Reg Loss: 0.403604
2025-08-13 13:21:52,014 [INFO] Epoch 6/100 - Val Loss: 0.1421
2025-08-13 13:21:52,418 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:21:55,791 [INFO] Epoch 7/100 - Val Loss: 0.1345
2025-08-13 13:21:56,202 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:21:59,564 [INFO] Epoch 8/100 - Val Loss: 0.1334
2025-08-13 13:22:03,349 [INFO] Epoch 9/100 - Val Loss: 0.1327
2025-08-13 13:22:03,748 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:22:07,106 [INFO] Epoch 10/100 - Val Loss: 0.1230
2025-08-13 13:22:07,458 [INFO] Epoch 10/100 - Train Loss: 0.5078, Val Loss: 0.1230, Val macro_f1: 0.9929, Avg Reg Loss: 0.399728
2025-08-13 13:22:10,833 [INFO] Epoch 11/100 - Val Loss: 0.1260
2025-08-13 13:22:11,224 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:22:14,590 [INFO] Epoch 12/100 - Val Loss: 0.1240
2025-08-13 13:22:14,934 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:22:18,306 [INFO] Epoch 13/100 - Val Loss: 0.1260
2025-08-13 13:22:18,712 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:22:22,064 [INFO] Epoch 14/100 - Val Loss: 0.1256
2025-08-13 13:22:22,461 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:22:25,812 [INFO] Epoch 15/100 - Val Loss: 0.1229
2025-08-13 13:22:26,217 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:22:26,217 [INFO] Epoch 15/100 - Train Loss: 0.4983, Val Loss: 0.1229, Val macro_f1: 0.9950, Avg Reg Loss: 0.396933
2025-08-13 13:22:29,559 [INFO] Epoch 16/100 - Val Loss: 0.1277
2025-08-13 13:22:33,234 [INFO] Epoch 17/100 - Val Loss: 0.1224
2025-08-13 13:22:37,006 [INFO] Epoch 18/100 - Val Loss: 0.1250
2025-08-13 13:22:40,726 [INFO] Epoch 19/100 - Val Loss: 0.1259
2025-08-13 13:22:44,644 [INFO] Epoch 20/100 - Val Loss: 0.1266
2025-08-13 13:22:44,984 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:22:44,984 [INFO] Epoch 20/100 - Train Loss: 0.4955, Val Loss: 0.1266, Val macro_f1: 0.9956, Avg Reg Loss: 0.395913
2025-08-13 13:22:48,307 [INFO] Epoch 21/100 - Val Loss: 0.1257
2025-08-13 13:22:52,058 [INFO] Epoch 22/100 - Val Loss: 0.1269
2025-08-13 13:22:55,795 [INFO] Epoch 23/100 - Val Loss: 0.1245
2025-08-13 13:22:59,540 [INFO] Epoch 24/100 - Val Loss: 0.1267
2025-08-13 13:23:03,240 [INFO] Epoch 25/100 - Val Loss: 0.1275
2025-08-13 13:23:03,603 [INFO] Epoch 25/100 - Train Loss: 0.4945, Val Loss: 0.1275, Val macro_f1: 0.9953, Avg Reg Loss: 0.395356
2025-08-13 13:23:06,978 [INFO] Epoch 26/100 - Val Loss: 0.1272
2025-08-13 13:23:10,728 [INFO] Epoch 27/100 - Val Loss: 0.1283
2025-08-13 13:23:14,475 [INFO] Epoch 28/100 - Val Loss: 0.1284
2025-08-13 13:23:14,886 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:23:18,257 [INFO] Epoch 29/100 - Val Loss: 0.1275
2025-08-13 13:23:22,010 [INFO] Epoch 30/100 - Val Loss: 0.1277
2025-08-13 13:23:22,372 [INFO] Epoch 30/100 - Train Loss: 0.4943, Val Loss: 0.1277, Val macro_f1: 0.9949, Avg Reg Loss: 0.395340
2025-08-13 13:23:25,761 [INFO] Epoch 31/100 - Val Loss: 0.1272
2025-08-13 13:23:29,698 [INFO] Epoch 32/100 - Val Loss: 0.1271
2025-08-13 13:23:33,398 [INFO] Epoch 33/100 - Val Loss: 0.1270
2025-08-13 13:23:33,810 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:23:37,191 [INFO] Epoch 34/100 - Val Loss: 0.1262
2025-08-13 13:23:40,941 [INFO] Epoch 35/100 - Val Loss: 0.1289
2025-08-13 13:23:41,295 [INFO] Epoch 35/100 - Train Loss: 0.4939, Val Loss: 0.1289, Val macro_f1: 0.9960, Avg Reg Loss: 0.395183
2025-08-13 13:23:44,687 [INFO] Epoch 36/100 - Val Loss: 0.1266
2025-08-13 13:23:48,359 [INFO] Epoch 37/100 - Val Loss: 0.1287
2025-08-13 13:23:52,104 [INFO] Epoch 38/100 - Val Loss: 0.1265
2025-08-13 13:23:55,841 [INFO] Epoch 39/100 - Val Loss: 0.1262
2025-08-13 13:23:59,596 [INFO] Epoch 40/100 - Val Loss: 0.1291
2025-08-13 13:23:59,946 [INFO] Epoch 40/100 - Train Loss: 0.4945, Val Loss: 0.1291, Val macro_f1: 0.9960, Avg Reg Loss: 0.395510
2025-08-13 13:24:03,274 [INFO] Epoch 41/100 - Val Loss: 0.1283
2025-08-13 13:24:07,010 [INFO] Epoch 42/100 - Val Loss: 0.1276
2025-08-13 13:24:10,774 [INFO] Epoch 43/100 - Val Loss: 0.1262
2025-08-13 13:24:11,313 [INFO] Early stopping at epoch 43
2025-08-13 13:24:11,671 [INFO] Collected test logits and targets
2025-08-13 13:24:11,855 [INFO] Calibration: T=0.3738, Details={'temperature': 0.37375831604003906, 'best_nll': 0.009256938472390175, 'method': 'logspace'}
2025-08-13 13:24:11,894 [INFO] Saved full results to results\paperA_cnn_hard_0.json
2025-08-13 13:51:26,863 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_enhanced_hard_0.json'}
2025-08-13 13:51:26,864 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-13 13:51:26,885 [INFO] Using device: cuda
2025-08-13 13:53:05,343 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_enhanced_hard_0.json'}
2025-08-13 13:53:05,344 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-13 13:53:05,367 [INFO] Using device: cuda
2025-08-13 13:56:13,557 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 13:56:13,678 [INFO] Model: enhanced with 1738120 params
2025-08-13 13:56:24,089 [INFO] Epoch 1/100 - Val Loss: 0.8383
2025-08-13 13:56:24,426 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:56:26,171 [INFO] Epoch 2/100 - Val Loss: 0.7971
2025-08-13 13:56:26,471 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:56:27,988 [INFO] Epoch 3/100 - Val Loss: 0.7892
2025-08-13 13:56:28,249 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:56:30,125 [INFO] Epoch 4/100 - Val Loss: 0.8016
2025-08-13 13:56:31,874 [INFO] Epoch 5/100 - Val Loss: 0.8224
2025-08-13 13:56:32,142 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 13:56:32,143 [INFO] Epoch 5/100 - Train Loss: 1.0364, Val Loss: 0.8224, Val macro_f1: 0.7092, Avg Reg Loss: 0.349042
2025-08-13 13:56:33,806 [INFO] Epoch 6/100 - Val Loss: 0.8345
2025-08-13 13:56:35,526 [INFO] Epoch 7/100 - Val Loss: 0.8240
2025-08-13 13:56:37,460 [INFO] Epoch 8/100 - Val Loss: 0.8881
2025-08-13 13:56:39,267 [INFO] Epoch 9/100 - Val Loss: 0.9292
2025-08-13 13:56:41,287 [INFO] Epoch 10/100 - Val Loss: 0.9373
2025-08-13 13:56:41,556 [INFO] Epoch 10/100 - Train Loss: 0.7638, Val Loss: 0.9373, Val macro_f1: 0.6856, Avg Reg Loss: 0.380640
2025-08-13 13:56:43,113 [INFO] Epoch 11/100 - Val Loss: 0.9633
2025-08-13 13:56:45,260 [INFO] Epoch 12/100 - Val Loss: 1.0330
2025-08-13 13:56:47,269 [INFO] Epoch 13/100 - Val Loss: 1.0210
2025-08-13 13:56:49,187 [INFO] Epoch 14/100 - Val Loss: 1.0239
2025-08-13 13:56:51,155 [INFO] Epoch 15/100 - Val Loss: 1.0453
2025-08-13 13:56:51,425 [INFO] Early stopping at epoch 15
2025-08-13 13:56:51,687 [INFO] Collected test logits and targets
2025-08-13 13:56:51,757 [INFO] Calibration: T=1.0672, Details={'temperature': 1.0671887397766113, 'best_nll': 1.0502394437789917, 'method': 'logspace'}
2025-08-13 13:56:51,794 [INFO] Saved full results to results\paperA_enhanced_hard_0.json
2025-08-13 13:56:56,429 [INFO] Starting training with args: {'model': 'bilstm', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_bilstm_hard_0.json'}
2025-08-13 13:56:56,429 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-13 13:56:56,466 [INFO] Using device: cuda
2025-08-13 14:00:06,494 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 14:00:06,626 [INFO] Model: bilstm with 583688 params
2025-08-13 14:00:18,515 [INFO] Epoch 1/100 - Val Loss: 1.9456
2025-08-13 14:00:18,919 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:00:21,894 [INFO] Epoch 2/100 - Val Loss: 1.4694
2025-08-13 14:00:22,267 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:00:25,314 [INFO] Epoch 3/100 - Val Loss: 1.0675
2025-08-13 14:00:25,702 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:00:28,705 [INFO] Epoch 4/100 - Val Loss: 1.0197
2025-08-13 14:00:29,066 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:00:32,248 [INFO] Epoch 5/100 - Val Loss: 0.9755
2025-08-13 14:00:32,608 [INFO] Epoch 5/100 - Train Loss: 1.3088, Val Loss: 0.9755, Val macro_f1: 0.5722, Avg Reg Loss: 0.338381
2025-08-13 14:00:35,646 [INFO] Epoch 6/100 - Val Loss: 0.9487
2025-08-13 14:00:36,037 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:00:39,017 [INFO] Epoch 7/100 - Val Loss: 0.8507
2025-08-13 14:00:39,392 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:00:42,389 [INFO] Epoch 8/100 - Val Loss: 0.8335
2025-08-13 14:00:47,135 [INFO] Epoch 9/100 - Val Loss: 0.8251
2025-08-13 14:00:50,903 [INFO] Epoch 10/100 - Val Loss: 0.8743
2025-08-13 14:00:51,259 [INFO] Epoch 10/100 - Train Loss: 1.2050, Val Loss: 0.8743, Val macro_f1: 0.6722, Avg Reg Loss: 0.342374
2025-08-13 14:00:54,238 [INFO] Epoch 11/100 - Val Loss: 0.8360
2025-08-13 14:00:57,591 [INFO] Epoch 12/100 - Val Loss: 0.8294
2025-08-13 14:01:00,952 [INFO] Epoch 13/100 - Val Loss: 0.8050
2025-08-13 14:01:01,323 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:01:04,297 [INFO] Epoch 14/100 - Val Loss: 0.8041
2025-08-13 14:01:07,844 [INFO] Epoch 15/100 - Val Loss: 0.7988
2025-08-13 14:01:08,223 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:01:08,224 [INFO] Epoch 15/100 - Train Loss: 1.1561, Val Loss: 0.7988, Val macro_f1: 0.7002, Avg Reg Loss: 0.346674
2025-08-13 14:01:11,239 [INFO] Epoch 16/100 - Val Loss: 0.7837
2025-08-13 14:01:11,614 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:01:14,620 [INFO] Epoch 17/100 - Val Loss: 0.8267
2025-08-13 14:01:17,982 [INFO] Epoch 18/100 - Val Loss: 0.8068
2025-08-13 14:01:21,507 [INFO] Epoch 19/100 - Val Loss: 0.7935
2025-08-13 14:01:24,857 [INFO] Epoch 20/100 - Val Loss: 0.7570
2025-08-13 14:01:25,243 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:01:25,244 [INFO] Epoch 20/100 - Train Loss: 1.1260, Val Loss: 0.7570, Val macro_f1: 0.7207, Avg Reg Loss: 0.343832
2025-08-13 14:01:28,241 [INFO] Epoch 21/100 - Val Loss: 0.8307
2025-08-13 14:01:31,608 [INFO] Epoch 22/100 - Val Loss: 0.8063
2025-08-13 14:01:34,996 [INFO] Epoch 23/100 - Val Loss: 0.7947
2025-08-13 14:01:38,537 [INFO] Epoch 24/100 - Val Loss: 0.7789
2025-08-13 14:01:41,877 [INFO] Epoch 25/100 - Val Loss: 0.7742
2025-08-13 14:01:42,246 [INFO] Epoch 25/100 - Train Loss: 1.1279, Val Loss: 0.7742, Val macro_f1: 0.7109, Avg Reg Loss: 0.345651
2025-08-13 14:01:45,382 [INFO] Epoch 26/100 - Val Loss: 0.7594
2025-08-13 14:01:48,762 [INFO] Epoch 27/100 - Val Loss: 0.8810
2025-08-13 14:01:52,327 [INFO] Epoch 28/100 - Val Loss: 0.7943
2025-08-13 14:01:55,704 [INFO] Epoch 29/100 - Val Loss: 0.7516
2025-08-13 14:01:56,080 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:01:59,081 [INFO] Epoch 30/100 - Val Loss: 0.6719
2025-08-13 14:01:59,460 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:01:59,461 [INFO] Epoch 30/100 - Train Loss: 1.0635, Val Loss: 0.6719, Val macro_f1: 0.7755, Avg Reg Loss: 0.341620
2025-08-13 14:02:02,631 [INFO] Epoch 31/100 - Val Loss: 0.8714
2025-08-13 14:02:05,978 [INFO] Epoch 32/100 - Val Loss: 0.7789
2025-08-13 14:02:09,338 [INFO] Epoch 33/100 - Val Loss: 0.7386
2025-08-13 14:02:12,706 [INFO] Epoch 34/100 - Val Loss: 0.8010
2025-08-13 14:02:16,071 [INFO] Epoch 35/100 - Val Loss: 0.6907
2025-08-13 14:02:16,440 [INFO] Epoch 35/100 - Train Loss: 1.0782, Val Loss: 0.6907, Val macro_f1: 0.7640, Avg Reg Loss: 0.346260
2025-08-13 14:02:19,379 [INFO] Epoch 36/100 - Val Loss: 0.5144
2025-08-13 14:02:19,776 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:02:22,925 [INFO] Epoch 37/100 - Val Loss: 0.5564
2025-08-13 14:02:26,313 [INFO] Epoch 38/100 - Val Loss: 0.5345
2025-08-13 14:02:26,695 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:02:29,689 [INFO] Epoch 39/100 - Val Loss: 0.5146
2025-08-13 14:02:30,074 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:02:33,084 [INFO] Epoch 40/100 - Val Loss: 0.4211
2025-08-13 14:02:33,465 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:02:33,466 [INFO] Epoch 40/100 - Train Loss: 0.8076, Val Loss: 0.4211, Val macro_f1: 0.8901, Avg Reg Loss: 0.368285
2025-08-13 14:02:36,648 [INFO] Epoch 41/100 - Val Loss: 0.5390
2025-08-13 14:02:40,009 [INFO] Epoch 42/100 - Val Loss: 0.4007
2025-08-13 14:02:43,367 [INFO] Epoch 43/100 - Val Loss: 0.2860
2025-08-13 14:02:43,741 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:02:46,768 [INFO] Epoch 44/100 - Val Loss: 0.2179
2025-08-13 14:02:47,153 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:02:50,352 [INFO] Epoch 45/100 - Val Loss: 0.2140
2025-08-13 14:02:50,735 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:02:50,736 [INFO] Epoch 45/100 - Train Loss: 0.6006, Val Loss: 0.2140, Val macro_f1: 0.9702, Avg Reg Loss: 0.392337
2025-08-13 14:02:53,753 [INFO] Epoch 46/100 - Val Loss: 0.2278
2025-08-13 14:02:57,113 [INFO] Epoch 47/100 - Val Loss: 0.2408
2025-08-13 14:03:00,479 [INFO] Epoch 48/100 - Val Loss: 0.1816
2025-08-13 14:03:01,061 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:03:04,058 [INFO] Epoch 49/100 - Val Loss: 0.2230
2025-08-13 14:03:07,426 [INFO] Epoch 50/100 - Val Loss: 0.2963
2025-08-13 14:03:07,798 [INFO] Epoch 50/100 - Train Loss: 0.5981, Val Loss: 0.2963, Val macro_f1: 0.9283, Avg Reg Loss: 0.388481
2025-08-13 14:03:10,802 [INFO] Epoch 51/100 - Val Loss: 0.2075
2025-08-13 14:03:14,359 [INFO] Epoch 52/100 - Val Loss: 0.1710
2025-08-13 14:03:14,747 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:03:17,717 [INFO] Epoch 53/100 - Val Loss: 0.2642
2025-08-13 14:03:21,080 [INFO] Epoch 54/100 - Val Loss: 0.3764
2025-08-13 14:03:24,444 [INFO] Epoch 55/100 - Val Loss: 0.1720
2025-08-13 14:03:24,824 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:03:24,825 [INFO] Epoch 55/100 - Train Loss: 0.6446, Val Loss: 0.1720, Val macro_f1: 0.9830, Avg Reg Loss: 0.378797
2025-08-13 14:03:28,027 [INFO] Epoch 56/100 - Val Loss: 0.2103
2025-08-13 14:03:31,382 [INFO] Epoch 57/100 - Val Loss: 0.1425
2025-08-13 14:03:31,768 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:03:34,771 [INFO] Epoch 58/100 - Val Loss: 0.1509
2025-08-13 14:03:38,181 [INFO] Epoch 59/100 - Val Loss: 0.1422
2025-08-13 14:03:38,561 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:03:41,571 [INFO] Epoch 60/100 - Val Loss: 0.1222
2025-08-13 14:03:41,954 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:03:41,955 [INFO] Epoch 60/100 - Train Loss: 0.5204, Val Loss: 0.1222, Val macro_f1: 0.9939, Avg Reg Loss: 0.393204
2025-08-13 14:03:44,969 [INFO] Epoch 61/100 - Val Loss: 0.1262
2025-08-13 14:03:48,539 [INFO] Epoch 62/100 - Val Loss: 0.1559
2025-08-13 14:03:51,918 [INFO] Epoch 63/100 - Val Loss: 0.1377
2025-08-13 14:03:55,271 [INFO] Epoch 64/100 - Val Loss: 0.1313
2025-08-13 14:03:58,650 [INFO] Epoch 65/100 - Val Loss: 0.1414
2025-08-13 14:03:59,199 [INFO] Epoch 65/100 - Train Loss: 0.5190, Val Loss: 0.1414, Val macro_f1: 0.9860, Avg Reg Loss: 0.393378
2025-08-13 14:04:02,205 [INFO] Epoch 66/100 - Val Loss: 0.1265
2025-08-13 14:04:05,555 [INFO] Epoch 67/100 - Val Loss: 0.1468
2025-08-13 14:04:08,908 [INFO] Epoch 68/100 - Val Loss: 0.1190
2025-08-13 14:04:09,292 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:04:12,286 [INFO] Epoch 69/100 - Val Loss: 0.1180
2025-08-13 14:04:12,675 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:04:15,692 [INFO] Epoch 70/100 - Val Loss: 0.1222
2025-08-13 14:04:16,049 [INFO] Epoch 70/100 - Train Loss: 0.5094, Val Loss: 0.1222, Val macro_f1: 0.9909, Avg Reg Loss: 0.394657
2025-08-13 14:04:19,264 [INFO] Epoch 71/100 - Val Loss: 0.1247
2025-08-13 14:04:22,651 [INFO] Epoch 72/100 - Val Loss: 0.1276
2025-08-13 14:04:26,008 [INFO] Epoch 73/100 - Val Loss: 0.1231
2025-08-13 14:04:29,383 [INFO] Epoch 74/100 - Val Loss: 0.1187
2025-08-13 14:04:32,986 [INFO] Epoch 75/100 - Val Loss: 0.1308
2025-08-13 14:04:33,356 [INFO] Epoch 75/100 - Train Loss: 0.5019, Val Loss: 0.1308, Val macro_f1: 0.9893, Avg Reg Loss: 0.395648
2025-08-13 14:04:36,344 [INFO] Epoch 76/100 - Val Loss: 0.1269
2025-08-13 14:04:39,703 [INFO] Epoch 77/100 - Val Loss: 0.1210
2025-08-13 14:04:43,248 [INFO] Epoch 78/100 - Val Loss: 0.1207
2025-08-13 14:04:46,629 [INFO] Epoch 79/100 - Val Loss: 0.1163
2025-08-13 14:04:47,004 [INFO] Early stopping at epoch 79
2025-08-13 14:04:47,376 [INFO] Collected test logits and targets
2025-08-13 14:04:47,535 [INFO] Calibration: T=0.5006, Details={'temperature': 0.5006030201911926, 'best_nll': 0.021902885288000107, 'method': 'logspace'}
2025-08-13 14:04:47,570 [INFO] Saved full results to results\paperA_bilstm_hard_0.json
2025-08-13 14:04:52,614 [INFO] Starting training with args: {'model': 'cnn', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_cnn_hard_0.json'}
2025-08-13 14:04:52,614 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-13 14:04:52,639 [INFO] Using device: cuda
2025-08-13 14:08:04,108 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 14:08:04,250 [INFO] Model: cnn with 3427848 params
2025-08-13 14:08:17,007 [INFO] Epoch 1/100 - Val Loss: 1.4853
2025-08-13 14:08:17,436 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:08:20,626 [INFO] Epoch 2/100 - Val Loss: 0.5979
2025-08-13 14:08:21,037 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:08:24,301 [INFO] Epoch 3/100 - Val Loss: 0.4554
2025-08-13 14:08:24,729 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:08:28,130 [INFO] Epoch 4/100 - Val Loss: 0.3810
2025-08-13 14:08:28,538 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:08:31,774 [INFO] Epoch 5/100 - Val Loss: 0.2946
2025-08-13 14:08:32,186 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:08:32,187 [INFO] Epoch 5/100 - Train Loss: 0.7461, Val Loss: 0.2946, Val macro_f1: 0.9530, Avg Reg Loss: 0.418253
2025-08-13 14:08:35,392 [INFO] Epoch 6/100 - Val Loss: 0.2378
2025-08-13 14:08:35,796 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:08:39,007 [INFO] Epoch 7/100 - Val Loss: 0.2155
2025-08-13 14:08:39,415 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:08:42,865 [INFO] Epoch 8/100 - Val Loss: 0.1893
2025-08-13 14:08:43,248 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:08:46,504 [INFO] Epoch 9/100 - Val Loss: 0.1807
2025-08-13 14:08:46,909 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:08:50,156 [INFO] Epoch 10/100 - Val Loss: 0.1679
2025-08-13 14:08:50,517 [INFO] Epoch 10/100 - Train Loss: 0.5631, Val Loss: 0.1679, Val macro_f1: 0.9865, Avg Reg Loss: 0.404837
2025-08-13 14:08:53,753 [INFO] Epoch 11/100 - Val Loss: 0.1520
2025-08-13 14:08:54,164 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:08:57,419 [INFO] Epoch 12/100 - Val Loss: 0.1585
2025-08-13 14:08:57,820 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:09:01,022 [INFO] Epoch 13/100 - Val Loss: 0.1436
2025-08-13 14:09:01,439 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:09:04,847 [INFO] Epoch 14/100 - Val Loss: 0.1412
2025-08-13 14:09:08,440 [INFO] Epoch 15/100 - Val Loss: 0.1435
2025-08-13 14:09:08,793 [INFO] Epoch 15/100 - Train Loss: 0.5254, Val Loss: 0.1435, Val macro_f1: 0.9922, Avg Reg Loss: 0.401977
2025-08-13 14:09:11,985 [INFO] Epoch 16/100 - Val Loss: 0.1422
2025-08-13 14:09:15,563 [INFO] Epoch 17/100 - Val Loss: 0.1353
2025-08-13 14:09:15,953 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:09:19,293 [INFO] Epoch 18/100 - Val Loss: 0.1403
2025-08-13 14:09:22,877 [INFO] Epoch 19/100 - Val Loss: 0.1377
2025-08-13 14:09:23,280 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:09:26,508 [INFO] Epoch 20/100 - Val Loss: 0.1339
2025-08-13 14:09:26,919 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:09:26,920 [INFO] Epoch 20/100 - Train Loss: 0.5132, Val Loss: 0.1339, Val macro_f1: 0.9953, Avg Reg Loss: 0.400216
2025-08-13 14:09:30,124 [INFO] Epoch 21/100 - Val Loss: 0.1355
2025-08-13 14:09:33,913 [INFO] Epoch 22/100 - Val Loss: 0.1320
2025-08-13 14:09:37,485 [INFO] Epoch 23/100 - Val Loss: 0.1292
2025-08-13 14:09:41,054 [INFO] Epoch 24/100 - Val Loss: 0.1341
2025-08-13 14:09:41,434 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-13 14:09:44,665 [INFO] Epoch 25/100 - Val Loss: 0.1301
2025-08-13 14:09:45,217 [INFO] Epoch 25/100 - Train Loss: 0.5070, Val Loss: 0.1301, Val macro_f1: 0.9936, Avg Reg Loss: 0.398915
2025-08-13 14:09:48,424 [INFO] Epoch 26/100 - Val Loss: 0.1334
2025-08-13 14:09:51,986 [INFO] Epoch 27/100 - Val Loss: 0.1323
2025-08-13 14:09:55,565 [INFO] Epoch 28/100 - Val Loss: 0.1331
2025-08-13 14:09:59,338 [INFO] Epoch 29/100 - Val Loss: 0.1307
2025-08-13 14:10:02,916 [INFO] Epoch 30/100 - Val Loss: 0.1302
2025-08-13 14:10:03,281 [INFO] Epoch 30/100 - Train Loss: 0.5032, Val Loss: 0.1302, Val macro_f1: 0.9950, Avg Reg Loss: 0.398337
2025-08-13 14:10:06,428 [INFO] Epoch 31/100 - Val Loss: 0.1315
2025-08-13 14:10:10,012 [INFO] Epoch 32/100 - Val Loss: 0.1346
2025-08-13 14:10:13,758 [INFO] Epoch 33/100 - Val Loss: 0.1288
2025-08-13 14:10:17,323 [INFO] Epoch 34/100 - Val Loss: 0.1289
2025-08-13 14:10:17,697 [INFO] Early stopping at epoch 34
2025-08-13 14:10:18,059 [INFO] Collected test logits and targets
2025-08-13 14:10:18,221 [INFO] Calibration: T=0.3923, Details={'temperature': 0.39225026965141296, 'best_nll': 0.01094385888427496, 'method': 'logspace'}
2025-08-13 14:10:18,255 [INFO] Saved full results to results\paperA_cnn_hard_0.json
2025-08-14 13:50:12,355 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_enhanced_hard_0.json'}
2025-08-14 13:50:12,356 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-14 13:50:12,601 [INFO] Using device: cuda
2025-08-14 13:53:35,311 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-14 13:53:35,518 [INFO] Model: enhanced with 61184 params
2025-08-14 13:55:02,422 [INFO] Epoch 1/100 - Val Loss: 3.4083
2025-08-14 13:55:19,282 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 13:56:29,143 [INFO] Epoch 2/100 - Val Loss: 3.8659
2025-08-14 13:56:45,626 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 13:57:55,109 [INFO] Epoch 3/100 - Val Loss: 2.4032
2025-08-14 13:58:11,810 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 13:59:21,703 [INFO] Epoch 4/100 - Val Loss: 0.4784
2025-08-14 13:59:38,527 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:00:48,687 [INFO] Epoch 5/100 - Val Loss: 0.2081
2025-08-14 14:01:05,522 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:01:05,523 [INFO] Epoch 5/100 - Train Loss: 0.6719, Val Loss: 0.2081, Val macro_f1: 0.9739, Avg Reg Loss: 0.430211
2025-08-14 14:02:16,055 [INFO] Epoch 6/100 - Val Loss: 0.1632
2025-08-14 14:02:33,032 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:03:43,206 [INFO] Epoch 7/100 - Val Loss: 0.1400
2025-08-14 14:04:00,078 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:05:09,897 [INFO] Epoch 8/100 - Val Loss: 0.1304
2025-08-14 14:05:26,614 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:06:36,380 [INFO] Epoch 9/100 - Val Loss: 0.1298
2025-08-14 14:08:02,922 [INFO] Epoch 10/100 - Val Loss: 0.1278
2025-08-14 14:08:19,784 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:08:19,785 [INFO] Epoch 10/100 - Train Loss: 0.5363, Val Loss: 0.1278, Val macro_f1: 0.9956, Avg Reg Loss: 0.407513
2025-08-14 14:09:29,328 [INFO] Epoch 11/100 - Val Loss: 0.1322
2025-08-14 14:10:55,702 [INFO] Epoch 12/100 - Val Loss: 0.1220
2025-08-14 14:12:22,821 [INFO] Epoch 13/100 - Val Loss: 0.1195
2025-08-14 14:13:49,230 [INFO] Epoch 14/100 - Val Loss: 0.1119
2025-08-14 14:14:06,041 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:15:15,420 [INFO] Epoch 15/100 - Val Loss: 0.1090
2025-08-14 14:15:32,201 [INFO] Epoch 15/100 - Train Loss: 0.5149, Val Loss: 0.1090, Val macro_f1: 0.9983, Avg Reg Loss: 0.402000
2025-08-14 14:16:42,346 [INFO] Epoch 16/100 - Val Loss: 0.1195
2025-08-14 14:18:08,979 [INFO] Epoch 17/100 - Val Loss: 0.1117
2025-08-14 14:18:25,803 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:19:35,700 [INFO] Epoch 18/100 - Val Loss: 0.1080
2025-08-14 14:19:52,584 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:21:03,282 [INFO] Epoch 19/100 - Val Loss: 0.1069
2025-08-14 14:22:29,883 [INFO] Epoch 20/100 - Val Loss: 0.1070
2025-08-14 14:22:46,667 [INFO] Epoch 20/100 - Train Loss: 0.5079, Val Loss: 0.1070, Val macro_f1: 0.9987, Avg Reg Loss: 0.399981
2025-08-14 14:23:57,076 [INFO] Epoch 21/100 - Val Loss: 0.1050
2025-08-14 14:24:13,906 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:25:23,585 [INFO] Epoch 22/100 - Val Loss: 0.1015
2025-08-14 14:26:50,212 [INFO] Epoch 23/100 - Val Loss: 0.1079
2025-08-14 14:28:16,528 [INFO] Epoch 24/100 - Val Loss: 0.1059
2025-08-14 14:29:42,607 [INFO] Epoch 25/100 - Val Loss: 0.1040
2025-08-14 14:29:59,186 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:29:59,187 [INFO] Epoch 25/100 - Train Loss: 0.5066, Val Loss: 0.1040, Val macro_f1: 0.9993, Avg Reg Loss: 0.399692
2025-08-14 14:31:08,692 [INFO] Epoch 26/100 - Val Loss: 0.1048
2025-08-14 14:32:34,494 [INFO] Epoch 27/100 - Val Loss: 0.1033
2025-08-14 14:33:59,884 [INFO] Epoch 28/100 - Val Loss: 0.1022
2025-08-14 14:35:25,671 [INFO] Epoch 29/100 - Val Loss: 0.1038
2025-08-14 14:36:52,606 [INFO] Epoch 30/100 - Val Loss: 0.0995
2025-08-14 14:37:09,414 [INFO] Epoch 30/100 - Train Loss: 0.5016, Val Loss: 0.0995, Val macro_f1: 0.9993, Avg Reg Loss: 0.398297
2025-08-14 14:38:18,796 [INFO] Epoch 31/100 - Val Loss: 0.1030
2025-08-14 14:38:35,622 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:39:45,135 [INFO] Epoch 32/100 - Val Loss: 0.1025
2025-08-14 14:41:11,997 [INFO] Epoch 33/100 - Val Loss: 0.1029
2025-08-14 14:42:38,546 [INFO] Epoch 34/100 - Val Loss: 0.1008
2025-08-14 14:44:04,532 [INFO] Epoch 35/100 - Val Loss: 0.1035
2025-08-14 14:44:21,273 [INFO] Epoch 35/100 - Train Loss: 0.5001, Val Loss: 0.1035, Val macro_f1: 0.9997, Avg Reg Loss: 0.397514
2025-08-14 14:45:30,248 [INFO] Epoch 36/100 - Val Loss: 0.1031
2025-08-14 14:46:57,817 [INFO] Epoch 37/100 - Val Loss: 0.1071
2025-08-14 14:48:24,749 [INFO] Epoch 38/100 - Val Loss: 0.1024
2025-08-14 14:49:51,974 [INFO] Epoch 39/100 - Val Loss: 0.1042
2025-08-14 14:51:18,352 [INFO] Epoch 40/100 - Val Loss: 0.1169
2025-08-14 14:51:35,201 [INFO] Epoch 40/100 - Train Loss: 0.5028, Val Loss: 0.1169, Val macro_f1: 0.9963, Avg Reg Loss: 0.399573
2025-08-14 14:52:44,743 [INFO] Epoch 41/100 - Val Loss: 0.1006
2025-08-14 14:53:01,529 [INFO] Early stopping at epoch 41
2025-08-14 14:53:18,338 [INFO] Collected test logits and targets
2025-08-14 14:53:18,529 [INFO] Calibration: T=0.3696, Details={'temperature': 0.369555801153183, 'best_nll': 0.0020983193535357714, 'method': 'logspace'}
2025-08-14 14:53:18,567 [INFO] Saved full results to results\paperA_enhanced_hard_0.json
2025-08-14 14:53:24,179 [INFO] Starting training with args: {'model': 'bilstm', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_bilstm_hard_0.json'}
2025-08-14 14:53:24,179 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-14 14:53:24,227 [INFO] Using device: cuda
2025-08-14 14:56:43,168 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-14 14:56:43,312 [INFO] Model: bilstm with 583688 params
2025-08-14 14:57:24,442 [INFO] Epoch 1/100 - Val Loss: 1.9426
2025-08-14 14:57:38,841 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:58:11,234 [INFO] Epoch 2/100 - Val Loss: 1.4339
2025-08-14 14:58:26,203 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:58:56,772 [INFO] Epoch 3/100 - Val Loss: 1.1478
2025-08-14 14:59:10,999 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 14:59:41,772 [INFO] Epoch 4/100 - Val Loss: 0.9679
2025-08-14 14:59:56,179 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:00:27,561 [INFO] Epoch 5/100 - Val Loss: 0.9715
2025-08-14 15:00:41,797 [INFO] Epoch 5/100 - Train Loss: 1.3095, Val Loss: 0.9715, Val macro_f1: 0.5924, Avg Reg Loss: 0.341491
2025-08-14 15:01:13,175 [INFO] Epoch 6/100 - Val Loss: 0.8771
2025-08-14 15:01:27,968 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:01:58,563 [INFO] Epoch 7/100 - Val Loss: 0.8666
2025-08-14 15:02:44,116 [INFO] Epoch 8/100 - Val Loss: 0.8690
2025-08-14 15:02:58,392 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:03:29,114 [INFO] Epoch 9/100 - Val Loss: 0.8383
2025-08-14 15:04:14,692 [INFO] Epoch 10/100 - Val Loss: 0.8381
2025-08-14 15:04:29,513 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:04:29,514 [INFO] Epoch 10/100 - Train Loss: 1.1876, Val Loss: 0.8381, Val macro_f1: 0.6755, Avg Reg Loss: 0.342928
2025-08-14 15:05:00,889 [INFO] Epoch 11/100 - Val Loss: 0.8212
2025-08-14 15:05:15,255 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:05:46,862 [INFO] Epoch 12/100 - Val Loss: 0.8512
2025-08-14 15:06:32,246 [INFO] Epoch 13/100 - Val Loss: 0.7888
2025-08-14 15:06:46,484 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:07:17,025 [INFO] Epoch 14/100 - Val Loss: 0.8011
2025-08-14 15:07:31,450 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:08:02,205 [INFO] Epoch 15/100 - Val Loss: 0.7906
2025-08-14 15:08:17,026 [INFO] Epoch 15/100 - Train Loss: 1.1349, Val Loss: 0.7906, Val macro_f1: 0.6841, Avg Reg Loss: 0.344668
2025-08-14 15:08:47,616 [INFO] Epoch 16/100 - Val Loss: 0.8793
2025-08-14 15:09:33,403 [INFO] Epoch 17/100 - Val Loss: 0.8279
2025-08-14 15:10:18,971 [INFO] Epoch 18/100 - Val Loss: 0.8026
2025-08-14 15:11:04,563 [INFO] Epoch 19/100 - Val Loss: 0.7714
2025-08-14 15:11:50,554 [INFO] Epoch 20/100 - Val Loss: 0.7479
2025-08-14 15:12:05,549 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:12:05,549 [INFO] Epoch 20/100 - Train Loss: 1.1092, Val Loss: 0.7479, Val macro_f1: 0.7330, Avg Reg Loss: 0.348483
2025-08-14 15:12:37,579 [INFO] Epoch 21/100 - Val Loss: 0.8492
2025-08-14 15:13:22,526 [INFO] Epoch 22/100 - Val Loss: 0.7521
2025-08-14 15:14:08,152 [INFO] Epoch 23/100 - Val Loss: 0.7024
2025-08-14 15:14:22,458 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:14:53,500 [INFO] Epoch 24/100 - Val Loss: 1.0861
2025-08-14 15:15:40,981 [INFO] Epoch 25/100 - Val Loss: 0.7912
2025-08-14 15:15:57,152 [INFO] Epoch 25/100 - Train Loss: 1.1462, Val Loss: 0.7912, Val macro_f1: 0.7204, Avg Reg Loss: 0.333466
2025-08-14 15:16:29,967 [INFO] Epoch 26/100 - Val Loss: 0.6388
2025-08-14 15:16:45,331 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:17:18,095 [INFO] Epoch 27/100 - Val Loss: 0.9098
2025-08-14 15:18:07,374 [INFO] Epoch 28/100 - Val Loss: 0.7038
2025-08-14 15:18:55,630 [INFO] Epoch 29/100 - Val Loss: 0.9183
2025-08-14 15:19:41,017 [INFO] Epoch 30/100 - Val Loss: 0.6703
2025-08-14 15:19:55,171 [INFO] Epoch 30/100 - Train Loss: 1.1286, Val Loss: 0.6703, Val macro_f1: 0.7747, Avg Reg Loss: 0.326248
2025-08-14 15:20:25,390 [INFO] Epoch 31/100 - Val Loss: 0.6234
2025-08-14 15:21:12,388 [INFO] Epoch 32/100 - Val Loss: 0.6047
2025-08-14 15:21:26,615 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:21:57,385 [INFO] Epoch 33/100 - Val Loss: 0.5213
2025-08-14 15:22:11,595 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:22:42,742 [INFO] Epoch 34/100 - Val Loss: 0.5007
2025-08-14 15:22:57,571 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:23:28,147 [INFO] Epoch 35/100 - Val Loss: 0.4539
2025-08-14 15:23:43,647 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:23:43,648 [INFO] Epoch 35/100 - Train Loss: 0.8691, Val Loss: 0.4539, Val macro_f1: 0.8530, Avg Reg Loss: 0.359729
2025-08-14 15:24:15,349 [INFO] Epoch 36/100 - Val Loss: 1.0349
2025-08-14 15:25:00,968 [INFO] Epoch 37/100 - Val Loss: 0.6056
2025-08-14 15:25:47,338 [INFO] Epoch 38/100 - Val Loss: 0.4824
2025-08-14 15:26:34,090 [INFO] Epoch 39/100 - Val Loss: 0.4916
2025-08-14 15:27:21,694 [INFO] Epoch 40/100 - Val Loss: 0.3959
2025-08-14 15:27:35,740 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:27:35,741 [INFO] Epoch 40/100 - Train Loss: 0.8101, Val Loss: 0.3959, Val macro_f1: 0.8761, Avg Reg Loss: 0.372269
2025-08-14 15:28:06,868 [INFO] Epoch 41/100 - Val Loss: 0.3939
2025-08-14 15:28:21,079 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:28:51,623 [INFO] Epoch 42/100 - Val Loss: 0.3131
2025-08-14 15:29:06,547 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:29:38,507 [INFO] Epoch 43/100 - Val Loss: 0.4267
2025-08-14 15:30:24,305 [INFO] Epoch 44/100 - Val Loss: 0.2955
2025-08-14 15:30:38,508 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:31:09,873 [INFO] Epoch 45/100 - Val Loss: 0.2497
2025-08-14 15:31:24,651 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:31:24,651 [INFO] Epoch 45/100 - Train Loss: 0.6226, Val Loss: 0.2497, Val macro_f1: 0.9572, Avg Reg Loss: 0.383437
2025-08-14 15:31:55,112 [INFO] Epoch 46/100 - Val Loss: 0.2254
2025-08-14 15:32:42,248 [INFO] Epoch 47/100 - Val Loss: 0.1986
2025-08-14 15:32:57,892 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:33:28,839 [INFO] Epoch 48/100 - Val Loss: 0.2401
2025-08-14 15:34:14,670 [INFO] Epoch 49/100 - Val Loss: 0.2730
2025-08-14 15:35:01,015 [INFO] Epoch 50/100 - Val Loss: 0.1908
2025-08-14 15:35:16,048 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:35:16,049 [INFO] Epoch 50/100 - Train Loss: 0.6266, Val Loss: 0.1908, Val macro_f1: 0.9806, Avg Reg Loss: 0.378323
2025-08-14 15:35:46,643 [INFO] Epoch 51/100 - Val Loss: 0.1597
2025-08-14 15:36:01,056 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:36:33,130 [INFO] Epoch 52/100 - Val Loss: 0.1401
2025-08-14 15:36:48,394 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:37:20,497 [INFO] Epoch 53/100 - Val Loss: 0.1472
2025-08-14 15:38:07,092 [INFO] Epoch 54/100 - Val Loss: 0.1399
2025-08-14 15:38:21,318 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:38:52,213 [INFO] Epoch 55/100 - Val Loss: 0.1299
2025-08-14 15:39:06,444 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:39:06,444 [INFO] Epoch 55/100 - Train Loss: 0.5166, Val Loss: 0.1299, Val macro_f1: 0.9916, Avg Reg Loss: 0.392426
2025-08-14 15:39:37,644 [INFO] Epoch 56/100 - Val Loss: 0.1286
2025-08-14 15:40:24,858 [INFO] Epoch 57/100 - Val Loss: 0.1252
2025-08-14 15:41:12,037 [INFO] Epoch 58/100 - Val Loss: 0.1262
2025-08-14 15:41:58,220 [INFO] Epoch 59/100 - Val Loss: 0.1208
2025-08-14 15:42:12,688 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:42:43,975 [INFO] Epoch 60/100 - Val Loss: 0.1196
2025-08-14 15:42:58,253 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:42:58,254 [INFO] Epoch 60/100 - Train Loss: 0.5071, Val Loss: 0.1196, Val macro_f1: 0.9933, Avg Reg Loss: 0.395157
2025-08-14 15:43:30,595 [INFO] Epoch 61/100 - Val Loss: 0.1328
2025-08-14 15:44:15,762 [INFO] Epoch 62/100 - Val Loss: 0.1511
2025-08-14 15:45:01,013 [INFO] Epoch 63/100 - Val Loss: 0.1296
2025-08-14 15:45:45,394 [INFO] Epoch 64/100 - Val Loss: 0.1377
2025-08-14 15:46:31,034 [INFO] Epoch 65/100 - Val Loss: 0.6911
2025-08-14 15:46:46,181 [INFO] Epoch 65/100 - Train Loss: 1.1671, Val Loss: 0.6911, Val macro_f1: 0.7204, Avg Reg Loss: 0.365131
2025-08-14 15:47:17,444 [INFO] Epoch 66/100 - Val Loss: 0.4777
2025-08-14 15:48:02,892 [INFO] Epoch 67/100 - Val Loss: 0.2331
2025-08-14 15:48:48,053 [INFO] Epoch 68/100 - Val Loss: 0.1929
2025-08-14 15:49:34,466 [INFO] Epoch 69/100 - Val Loss: 0.1517
2025-08-14 15:50:20,685 [INFO] Epoch 70/100 - Val Loss: 0.1401
2025-08-14 15:50:35,434 [INFO] Early stopping at epoch 70
2025-08-14 15:50:49,557 [INFO] Collected test logits and targets
2025-08-14 15:50:49,694 [INFO] Calibration: T=0.5495, Details={'temperature': 0.5494844317436218, 'best_nll': 0.05144456401467323, 'method': 'logspace'}
2025-08-14 15:50:49,730 [INFO] Saved full results to results\paperA_bilstm_hard_0.json
2025-08-14 15:50:54,673 [INFO] Starting training with args: {'model': 'cnn', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_cnn_hard_0.json'}
2025-08-14 15:50:54,673 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-14 15:50:54,711 [INFO] Using device: cuda
2025-08-14 15:54:03,874 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-14 15:54:04,031 [INFO] Model: cnn with 3427848 params
2025-08-14 15:54:46,512 [INFO] Epoch 1/100 - Val Loss: 1.2528
2025-08-14 15:55:01,431 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:55:32,431 [INFO] Epoch 2/100 - Val Loss: 0.6160
2025-08-14 15:55:47,173 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:56:19,860 [INFO] Epoch 3/100 - Val Loss: 0.5043
2025-08-14 15:56:34,995 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:57:06,534 [INFO] Epoch 4/100 - Val Loss: 0.4185
2025-08-14 15:57:21,545 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:57:53,002 [INFO] Epoch 5/100 - Val Loss: 0.3405
2025-08-14 15:58:07,880 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:58:07,880 [INFO] Epoch 5/100 - Train Loss: 0.7924, Val Loss: 0.3405, Val macro_f1: 0.9387, Avg Reg Loss: 0.418073
2025-08-14 15:58:39,035 [INFO] Epoch 6/100 - Val Loss: 0.2733
2025-08-14 15:58:53,857 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 15:59:24,982 [INFO] Epoch 7/100 - Val Loss: 0.2293
2025-08-14 15:59:39,212 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:00:11,248 [INFO] Epoch 8/100 - Val Loss: 0.2065
2025-08-14 16:00:26,039 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:00:56,826 [INFO] Epoch 9/100 - Val Loss: 0.1950
2025-08-14 16:01:11,879 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:01:43,827 [INFO] Epoch 10/100 - Val Loss: 0.1794
2025-08-14 16:01:58,654 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:01:58,655 [INFO] Epoch 10/100 - Train Loss: 0.5834, Val Loss: 0.1794, Val macro_f1: 0.9811, Avg Reg Loss: 0.409890
2025-08-14 16:02:30,157 [INFO] Epoch 11/100 - Val Loss: 0.1656
2025-08-14 16:02:44,426 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:03:15,971 [INFO] Epoch 12/100 - Val Loss: 0.1593
2025-08-14 16:03:31,012 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:04:02,489 [INFO] Epoch 13/100 - Val Loss: 0.1518
2025-08-14 16:04:16,780 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:04:48,163 [INFO] Epoch 14/100 - Val Loss: 0.1518
2025-08-14 16:05:35,332 [INFO] Epoch 15/100 - Val Loss: 0.1435
2025-08-14 16:05:51,696 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:05:51,697 [INFO] Epoch 15/100 - Train Loss: 0.5394, Val Loss: 0.1435, Val macro_f1: 0.9906, Avg Reg Loss: 0.404512
2025-08-14 16:06:24,258 [INFO] Epoch 16/100 - Val Loss: 0.1469
2025-08-14 16:06:39,379 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:07:12,243 [INFO] Epoch 17/100 - Val Loss: 0.1427
2025-08-14 16:07:27,886 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:07:59,119 [INFO] Epoch 18/100 - Val Loss: 0.1381
2025-08-14 16:08:45,025 [INFO] Epoch 19/100 - Val Loss: 0.1375
2025-08-14 16:09:30,832 [INFO] Epoch 20/100 - Val Loss: 0.1350
2025-08-14 16:09:45,206 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:09:45,206 [INFO] Epoch 20/100 - Train Loss: 0.5206, Val Loss: 0.1350, Val macro_f1: 0.9933, Avg Reg Loss: 0.401108
2025-08-14 16:10:16,838 [INFO] Epoch 21/100 - Val Loss: 0.1312
2025-08-14 16:11:04,275 [INFO] Epoch 22/100 - Val Loss: 0.1350
2025-08-14 16:11:49,987 [INFO] Epoch 23/100 - Val Loss: 0.1317
2025-08-14 16:12:35,764 [INFO] Epoch 24/100 - Val Loss: 0.1299
2025-08-14 16:12:50,024 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:13:21,782 [INFO] Epoch 25/100 - Val Loss: 0.1295
2025-08-14 16:13:36,823 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:13:36,823 [INFO] Epoch 25/100 - Train Loss: 0.5127, Val Loss: 0.1295, Val macro_f1: 0.9946, Avg Reg Loss: 0.400463
2025-08-14 16:14:08,160 [INFO] Epoch 26/100 - Val Loss: 0.1310
2025-08-14 16:14:53,935 [INFO] Epoch 27/100 - Val Loss: 0.1324
2025-08-14 16:15:39,144 [INFO] Epoch 28/100 - Val Loss: 0.1311
2025-08-14 16:15:53,390 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:16:23,982 [INFO] Epoch 29/100 - Val Loss: 0.1293
2025-08-14 16:16:38,025 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:17:09,562 [INFO] Epoch 30/100 - Val Loss: 0.1298
2025-08-14 16:17:24,326 [INFO] Epoch 30/100 - Train Loss: 0.5087, Val Loss: 0.1298, Val macro_f1: 0.9943, Avg Reg Loss: 0.399874
2025-08-14 16:17:57,352 [INFO] Epoch 31/100 - Val Loss: 0.1282
2025-08-14 16:18:12,597 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:18:43,761 [INFO] Epoch 32/100 - Val Loss: 0.1298
2025-08-14 16:19:29,320 [INFO] Epoch 33/100 - Val Loss: 0.1275
2025-08-14 16:19:43,602 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:20:14,930 [INFO] Epoch 34/100 - Val Loss: 0.1302
2025-08-14 16:21:01,137 [INFO] Epoch 35/100 - Val Loss: 0.1284
2025-08-14 16:21:15,480 [INFO] Epoch 35/100 - Train Loss: 0.5058, Val Loss: 0.1284, Val macro_f1: 0.9956, Avg Reg Loss: 0.399071
2025-08-14 16:21:46,685 [INFO] Epoch 36/100 - Val Loss: 0.1269
2025-08-14 16:22:31,070 [INFO] Epoch 37/100 - Val Loss: 0.1259
2025-08-14 16:22:45,101 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:23:15,920 [INFO] Epoch 38/100 - Val Loss: 0.1266
2025-08-14 16:24:00,916 [INFO] Epoch 39/100 - Val Loss: 0.1275
2025-08-14 16:24:46,993 [INFO] Epoch 40/100 - Val Loss: 0.1274
2025-08-14 16:25:01,835 [INFO] Epoch 40/100 - Train Loss: 0.5034, Val Loss: 0.1274, Val macro_f1: 0.9956, Avg Reg Loss: 0.397964
2025-08-14 16:25:32,639 [INFO] Epoch 41/100 - Val Loss: 0.1247
2025-08-14 16:26:18,158 [INFO] Epoch 42/100 - Val Loss: 0.1261
2025-08-14 16:27:03,735 [INFO] Epoch 43/100 - Val Loss: 0.1256
2025-08-14 16:27:18,939 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:27:50,425 [INFO] Epoch 44/100 - Val Loss: 0.1286
2025-08-14 16:28:37,021 [INFO] Epoch 45/100 - Val Loss: 0.1236
2025-08-14 16:28:52,146 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:28:52,146 [INFO] Epoch 45/100 - Train Loss: 0.5029, Val Loss: 0.1236, Val macro_f1: 0.9966, Avg Reg Loss: 0.398499
2025-08-14 16:29:23,868 [INFO] Epoch 46/100 - Val Loss: 0.1249
2025-08-14 16:30:08,780 [INFO] Epoch 47/100 - Val Loss: 0.1259
2025-08-14 16:30:56,176 [INFO] Epoch 48/100 - Val Loss: 0.1247
2025-08-14 16:31:42,027 [INFO] Epoch 49/100 - Val Loss: 0.1259
2025-08-14 16:32:27,527 [INFO] Epoch 50/100 - Val Loss: 0.1227
2025-08-14 16:32:41,767 [INFO] Epoch 50/100 - Train Loss: 0.5009, Val Loss: 0.1227, Val macro_f1: 0.9956, Avg Reg Loss: 0.397485
2025-08-14 16:33:14,353 [INFO] Epoch 51/100 - Val Loss: 0.1271
2025-08-14 16:34:00,594 [INFO] Epoch 52/100 - Val Loss: 0.1263
2025-08-14 16:34:47,713 [INFO] Epoch 53/100 - Val Loss: 0.1236
2025-08-14 16:35:33,766 [INFO] Epoch 54/100 - Val Loss: 0.1249
2025-08-14 16:36:19,493 [INFO] Epoch 55/100 - Val Loss: 0.1250
2025-08-14 16:36:34,298 [INFO] Early stopping at epoch 55
2025-08-14 16:36:48,323 [INFO] Collected test logits and targets
2025-08-14 16:36:48,480 [INFO] Calibration: T=0.3868, Details={'temperature': 0.3867877423763275, 'best_nll': 0.011072009801864624, 'method': 'logspace'}
2025-08-14 16:36:48,519 [INFO] Saved full results to results\paperA_cnn_hard_0.json
2025-08-14 16:36:53,594 [INFO] Starting training with args: {'model': 'conformer_lite', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_conformer_lite_hard_0.json'}
2025-08-14 16:36:53,594 [INFO] Logs saved to: results\train_eval_0_hard.log
2025-08-14 16:36:53,621 [INFO] Using device: cuda
2025-08-14 16:40:13,020 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-14 16:40:13,177 [INFO] Model: conformer_lite with 1721008 params
2025-08-14 16:41:15,316 [INFO] Epoch 1/100 - Val Loss: 2.7930
2025-08-14 16:41:31,235 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:42:22,221 [INFO] Epoch 2/100 - Val Loss: 3.4393
2025-08-14 16:43:29,615 [INFO] Epoch 3/100 - Val Loss: 1.0908
2025-08-14 16:43:45,362 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:44:36,577 [INFO] Epoch 4/100 - Val Loss: 0.2536
2025-08-14 16:44:52,221 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:45:43,925 [INFO] Epoch 5/100 - Val Loss: 0.2288
2025-08-14 16:46:00,271 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:46:00,272 [INFO] Epoch 5/100 - Train Loss: 0.6221, Val Loss: 0.2288, Val macro_f1: 0.9420, Avg Reg Loss: 0.444013
2025-08-14 16:46:52,139 [INFO] Epoch 6/100 - Val Loss: 0.2869
2025-08-14 16:47:58,856 [INFO] Epoch 7/100 - Val Loss: 0.3456
2025-08-14 16:49:06,171 [INFO] Epoch 8/100 - Val Loss: 0.8655
2025-08-14 16:50:14,517 [INFO] Epoch 9/100 - Val Loss: 0.1232
2025-08-14 16:50:30,130 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:51:21,315 [INFO] Epoch 10/100 - Val Loss: 0.1076
2025-08-14 16:51:36,946 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:51:36,947 [INFO] Epoch 10/100 - Train Loss: 0.5291, Val Loss: 0.1076, Val macro_f1: 0.9892, Avg Reg Loss: 0.401938
2025-08-14 16:52:28,482 [INFO] Epoch 11/100 - Val Loss: 0.1029
2025-08-14 16:52:44,140 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 16:53:35,170 [INFO] Epoch 12/100 - Val Loss: 0.1296
2025-08-14 16:54:42,533 [INFO] Epoch 13/100 - Val Loss: 0.0952
2025-08-14 16:55:49,775 [INFO] Epoch 14/100 - Val Loss: 0.2208
2025-08-14 16:56:58,524 [INFO] Epoch 15/100 - Val Loss: 0.2856
2025-08-14 16:57:14,168 [INFO] Epoch 15/100 - Train Loss: 0.5326, Val Loss: 0.2856, Val macro_f1: 0.9300, Avg Reg Loss: 0.406835
2025-08-14 16:58:06,498 [INFO] Epoch 16/100 - Val Loss: 0.1935
2025-08-14 16:59:13,611 [INFO] Epoch 17/100 - Val Loss: 0.1591
2025-08-14 17:00:21,187 [INFO] Epoch 18/100 - Val Loss: 0.0897
2025-08-14 17:00:36,926 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 17:01:27,877 [INFO] Epoch 19/100 - Val Loss: 0.0951
2025-08-14 17:02:34,286 [INFO] Epoch 20/100 - Val Loss: 0.0972
2025-08-14 17:02:49,850 [INFO] Epoch 20/100 - Train Loss: 0.5065, Val Loss: 0.0972, Val macro_f1: 0.9912, Avg Reg Loss: 0.399958
2025-08-14 17:03:42,159 [INFO] Epoch 21/100 - Val Loss: 0.0898
2025-08-14 17:03:58,541 [INFO] Best model saved to checkpoints\best_0_hard.pth
2025-08-14 17:04:54,169 [INFO] Epoch 22/100 - Val Loss: 0.1249
2025-08-14 17:06:19,739 [INFO] Epoch 23/100 - Val Loss: 0.0953
2025-08-14 17:07:44,261 [INFO] Epoch 24/100 - Val Loss: 0.4398
2025-08-14 17:09:08,343 [INFO] Epoch 25/100 - Val Loss: 0.1045
2025-08-14 17:09:24,080 [INFO] Epoch 25/100 - Train Loss: 0.5105, Val Loss: 0.1045, Val macro_f1: 0.9875, Avg Reg Loss: 0.398979
2025-08-14 17:10:31,841 [INFO] Epoch 26/100 - Val Loss: 0.1214
2025-08-14 17:11:56,377 [INFO] Epoch 27/100 - Val Loss: 0.0877
2025-08-14 17:13:20,459 [INFO] Epoch 28/100 - Val Loss: 0.0834
2025-08-14 17:14:44,225 [INFO] Epoch 29/100 - Val Loss: 0.1262
2025-08-14 17:16:00,912 [INFO] Epoch 30/100 - Val Loss: 0.1555
2025-08-14 17:16:17,401 [INFO] Epoch 30/100 - Train Loss: 0.4997, Val Loss: 0.1555, Val macro_f1: 0.9744, Avg Reg Loss: 0.396651
2025-08-14 17:17:26,289 [INFO] Epoch 31/100 - Val Loss: 0.0918
2025-08-14 17:17:43,483 [INFO] Early stopping at epoch 31
2025-08-14 17:17:59,800 [INFO] Collected test logits and targets
2025-08-14 17:17:59,961 [INFO] Calibration: T=0.5301, Details={'temperature': 0.5300859212875366, 'best_nll': 0.022076698020100594, 'method': 'logspace'}
2025-08-14 17:17:59,992 [INFO] Saved full results to results\paperA_conformer_lite_hard_0.json
