2025-08-13 12:47:48,250 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_enhanced_hard_1.json'}
2025-08-13 12:47:48,250 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-13 12:47:48,280 [INFO] Using device: cuda
2025-08-13 12:50:31,112 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 12:50:31,255 [INFO] Model: enhanced with 584200 params
2025-08-13 12:50:41,746 [INFO] Epoch 1/100 - Val Loss: 1.0228
2025-08-13 12:50:42,140 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:50:45,449 [INFO] Epoch 2/100 - Val Loss: 0.8927
2025-08-13 12:50:45,859 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:50:49,134 [INFO] Epoch 3/100 - Val Loss: 0.7671
2025-08-13 12:50:49,533 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:50:52,725 [INFO] Epoch 4/100 - Val Loss: 0.7661
2025-08-13 12:50:56,054 [INFO] Epoch 5/100 - Val Loss: 0.7589
2025-08-13 12:50:56,435 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:50:56,435 [INFO] Epoch 5/100 - Train Loss: 1.1783, Val Loss: 0.7589, Val macro_f1: 0.7365, Avg Reg Loss: 0.349662
2025-08-13 12:50:59,702 [INFO] Epoch 6/100 - Val Loss: 0.7115
2025-08-13 12:51:00,085 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:51:03,345 [INFO] Epoch 7/100 - Val Loss: 0.9877
2025-08-13 12:51:06,970 [INFO] Epoch 8/100 - Val Loss: 1.0296
2025-08-13 12:51:10,391 [INFO] Epoch 9/100 - Val Loss: 0.8243
2025-08-13 12:51:14,031 [INFO] Epoch 10/100 - Val Loss: 0.7628
2025-08-13 12:51:14,397 [INFO] Epoch 10/100 - Train Loss: 1.1395, Val Loss: 0.7628, Val macro_f1: 0.7192, Avg Reg Loss: 0.358193
2025-08-13 12:51:17,692 [INFO] Epoch 11/100 - Val Loss: 0.7280
2025-08-13 12:51:21,337 [INFO] Epoch 12/100 - Val Loss: 0.5399
2025-08-13 12:51:21,727 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:51:24,707 [INFO] Epoch 13/100 - Val Loss: 0.6986
2025-08-13 12:51:28,330 [INFO] Epoch 14/100 - Val Loss: 0.4770
2025-08-13 12:51:28,740 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:51:32,027 [INFO] Epoch 15/100 - Val Loss: 0.7306
2025-08-13 12:51:32,426 [INFO] Epoch 15/100 - Train Loss: 1.2145, Val Loss: 0.7306, Val macro_f1: 0.7376, Avg Reg Loss: 0.343865
2025-08-13 12:51:35,743 [INFO] Epoch 16/100 - Val Loss: 0.5711
2025-08-13 12:51:39,130 [INFO] Epoch 17/100 - Val Loss: 0.4451
2025-08-13 12:51:39,482 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:51:42,781 [INFO] Epoch 18/100 - Val Loss: 0.3117
2025-08-13 12:51:43,191 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:51:46,550 [INFO] Epoch 19/100 - Val Loss: 0.4105
2025-08-13 12:51:50,401 [INFO] Epoch 20/100 - Val Loss: 0.3646
2025-08-13 12:51:50,770 [INFO] Epoch 20/100 - Train Loss: 0.7645, Val Loss: 0.3646, Val macro_f1: 0.9070, Avg Reg Loss: 0.383211
2025-08-13 12:51:53,847 [INFO] Epoch 21/100 - Val Loss: 0.4175
2025-08-13 12:51:57,343 [INFO] Epoch 22/100 - Val Loss: 0.5094
2025-08-13 12:52:01,063 [INFO] Epoch 23/100 - Val Loss: 0.5663
2025-08-13 12:52:04,748 [INFO] Epoch 24/100 - Val Loss: 0.2709
2025-08-13 12:52:05,126 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:52:08,296 [INFO] Epoch 25/100 - Val Loss: 0.1696
2025-08-13 12:52:08,574 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:52:08,574 [INFO] Epoch 25/100 - Train Loss: 0.6874, Val Loss: 0.1696, Val macro_f1: 0.9811, Avg Reg Loss: 0.389029
2025-08-13 12:52:11,707 [INFO] Epoch 26/100 - Val Loss: 0.1462
2025-08-13 12:52:12,112 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:52:15,391 [INFO] Epoch 27/100 - Val Loss: 0.1182
2025-08-13 12:52:15,786 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:52:19,052 [INFO] Epoch 28/100 - Val Loss: 0.1271
2025-08-13 12:52:22,785 [INFO] Epoch 29/100 - Val Loss: 0.1200
2025-08-13 12:52:26,065 [INFO] Epoch 30/100 - Val Loss: 0.3253
2025-08-13 12:52:26,453 [INFO] Epoch 30/100 - Train Loss: 0.7528, Val Loss: 0.3253, Val macro_f1: 0.9023, Avg Reg Loss: 0.377517
2025-08-13 12:52:29,616 [INFO] Epoch 31/100 - Val Loss: 0.1270
2025-08-13 12:52:33,348 [INFO] Epoch 32/100 - Val Loss: 0.1353
2025-08-13 12:52:36,902 [INFO] Epoch 33/100 - Val Loss: 0.1200
2025-08-13 12:52:40,236 [INFO] Epoch 34/100 - Val Loss: 0.1178
2025-08-13 12:52:43,810 [INFO] Epoch 35/100 - Val Loss: 0.1172
2025-08-13 12:52:44,195 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:52:44,195 [INFO] Epoch 35/100 - Train Loss: 0.5057, Val Loss: 0.1172, Val macro_f1: 0.9942, Avg Reg Loss: 0.395250
2025-08-13 12:52:47,463 [INFO] Epoch 36/100 - Val Loss: 0.1349
2025-08-13 12:52:51,118 [INFO] Epoch 37/100 - Val Loss: 0.1180
2025-08-13 12:52:54,438 [INFO] Epoch 38/100 - Val Loss: 0.1123
2025-08-13 12:52:54,786 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 12:52:58,047 [INFO] Epoch 39/100 - Val Loss: 0.1159
2025-08-13 12:53:01,676 [INFO] Epoch 40/100 - Val Loss: 0.1194
2025-08-13 12:53:02,060 [INFO] Epoch 40/100 - Train Loss: 0.4964, Val Loss: 0.1194, Val macro_f1: 0.9929, Avg Reg Loss: 0.395722
2025-08-13 12:53:05,368 [INFO] Epoch 41/100 - Val Loss: 0.1104
2025-08-13 12:53:08,879 [INFO] Epoch 42/100 - Val Loss: 1.3842
2025-08-13 12:53:12,328 [INFO] Epoch 43/100 - Val Loss: 1.0813
2025-08-13 12:53:16,244 [INFO] Epoch 44/100 - Val Loss: 0.3190
2025-08-13 12:53:19,895 [INFO] Epoch 45/100 - Val Loss: 0.3114
2025-08-13 12:53:20,295 [INFO] Epoch 45/100 - Train Loss: 0.7539, Val Loss: 0.3114, Val macro_f1: 0.9183, Avg Reg Loss: 0.391836
2025-08-13 12:53:23,545 [INFO] Epoch 46/100 - Val Loss: 0.1345
2025-08-13 12:53:26,808 [INFO] Epoch 47/100 - Val Loss: 0.4286
2025-08-13 12:53:30,481 [INFO] Epoch 48/100 - Val Loss: 0.2879
2025-08-13 12:53:30,876 [INFO] Early stopping at epoch 48
2025-08-13 12:53:31,259 [INFO] Collected test logits and targets
2025-08-13 12:53:31,372 [INFO] Calibration: T=0.6849, Details={'temperature': 0.6849144697189331, 'best_nll': 0.21017751097679138, 'method': 'logspace'}
2025-08-13 12:53:31,406 [INFO] Saved full results to results\paperA_enhanced_hard_1.json
2025-08-13 12:53:36,276 [INFO] Starting training with args: {'model': 'bilstm', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_bilstm_hard_1.json'}
2025-08-13 12:53:36,276 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-13 12:53:36,301 [INFO] Using device: cuda
2025-08-13 12:56:18,974 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 12:56:18,975 [ERROR] Error: Unknown model bilstm
Traceback (most recent call last):
  File "E:\paperA\paperA\src\train_eval.py", line 358, in main
    model = build_model(args.model, args.F, args.num_classes)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\paperA\paperA\src\models.py", line 214, in build_model
    raise ValueError(f"Unknown model {name}")
ValueError: Unknown model bilstm
2025-08-13 12:56:23,266 [INFO] Starting training with args: {'model': 'cnn', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_cnn_hard_1.json'}
2025-08-13 12:56:23,266 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-13 12:56:23,292 [INFO] Using device: cuda
2025-08-13 12:59:05,919 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 12:59:05,919 [ERROR] Error: Unknown model cnn
Traceback (most recent call last):
  File "E:\paperA\paperA\src\train_eval.py", line 358, in main
    model = build_model(args.model, args.F, args.num_classes)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\paperA\paperA\src\models.py", line 214, in build_model
    raise ValueError(f"Unknown model {name}")
ValueError: Unknown model cnn
2025-08-13 13:24:16,791 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_enhanced_hard_1.json'}
2025-08-13 13:24:16,792 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-13 13:24:16,821 [INFO] Using device: cuda
2025-08-13 13:27:15,430 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 13:27:15,554 [INFO] Model: enhanced with 1738120 params
2025-08-13 13:27:26,199 [INFO] Epoch 1/100 - Val Loss: 0.7881
2025-08-13 13:27:26,515 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:27:28,504 [INFO] Epoch 2/100 - Val Loss: 0.8145
2025-08-13 13:27:30,755 [INFO] Epoch 3/100 - Val Loss: 0.8183
2025-08-13 13:27:32,784 [INFO] Epoch 4/100 - Val Loss: 0.8667
2025-08-13 13:27:34,916 [INFO] Epoch 5/100 - Val Loss: 0.8776
2025-08-13 13:27:35,162 [INFO] Epoch 5/100 - Train Loss: 0.9145, Val Loss: 0.8776, Val macro_f1: 0.6824, Avg Reg Loss: 0.365805
2025-08-13 13:27:37,137 [INFO] Epoch 6/100 - Val Loss: 0.9137
2025-08-13 13:27:39,532 [INFO] Epoch 7/100 - Val Loss: 0.9901
2025-08-13 13:27:41,772 [INFO] Epoch 8/100 - Val Loss: 0.9970
2025-08-13 13:27:44,066 [INFO] Epoch 9/100 - Val Loss: 0.9964
2025-08-13 13:27:46,376 [INFO] Epoch 10/100 - Val Loss: 1.0242
2025-08-13 13:27:46,598 [INFO] Epoch 10/100 - Train Loss: 0.6525, Val Loss: 1.0242, Val macro_f1: 0.6642, Avg Reg Loss: 0.392837
2025-08-13 13:27:48,256 [INFO] Epoch 11/100 - Val Loss: 1.0342
2025-08-13 13:27:48,488 [INFO] Early stopping at epoch 11
2025-08-13 13:27:48,707 [INFO] Collected test logits and targets
2025-08-13 13:27:48,807 [INFO] Calibration: T=0.9846, Details={'temperature': 0.9846433401107788, 'best_nll': 0.9757658839225769, 'method': 'logspace'}
2025-08-13 13:27:48,843 [INFO] Saved full results to results\paperA_enhanced_hard_1.json
2025-08-13 13:27:53,516 [INFO] Starting training with args: {'model': 'bilstm', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_bilstm_hard_1.json'}
2025-08-13 13:27:53,516 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-13 13:27:53,543 [INFO] Using device: cuda
2025-08-13 13:30:53,401 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 13:30:53,523 [INFO] Model: bilstm with 583688 params
2025-08-13 13:31:05,037 [INFO] Epoch 1/100 - Val Loss: 1.0856
2025-08-13 13:31:05,447 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:31:08,641 [INFO] Epoch 2/100 - Val Loss: 0.9308
2025-08-13 13:31:09,032 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:31:12,236 [INFO] Epoch 3/100 - Val Loss: 1.0021
2025-08-13 13:31:15,828 [INFO] Epoch 4/100 - Val Loss: 0.8509
2025-08-13 13:31:16,150 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:31:19,298 [INFO] Epoch 5/100 - Val Loss: 0.8895
2025-08-13 13:31:19,672 [INFO] Epoch 5/100 - Train Loss: 1.1976, Val Loss: 0.8895, Val macro_f1: 0.6480, Avg Reg Loss: 0.341292
2025-08-13 13:31:22,882 [INFO] Epoch 6/100 - Val Loss: 0.8090
2025-08-13 13:31:23,275 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:31:26,503 [INFO] Epoch 7/100 - Val Loss: 0.7837
2025-08-13 13:31:26,891 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:31:30,126 [INFO] Epoch 8/100 - Val Loss: 0.7863
2025-08-13 13:31:30,514 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:31:33,684 [INFO] Epoch 9/100 - Val Loss: 0.7132
2025-08-13 13:31:34,052 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:31:37,473 [INFO] Epoch 10/100 - Val Loss: 0.6466
2025-08-13 13:31:37,851 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:31:37,852 [INFO] Epoch 10/100 - Train Loss: 1.0548, Val Loss: 0.6466, Val macro_f1: 0.7451, Avg Reg Loss: 0.349316
2025-08-13 13:31:41,064 [INFO] Epoch 11/100 - Val Loss: 0.7907
2025-08-13 13:31:44,627 [INFO] Epoch 12/100 - Val Loss: 0.6768
2025-08-13 13:31:45,005 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:31:48,145 [INFO] Epoch 13/100 - Val Loss: 0.3467
2025-08-13 13:31:48,532 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:31:51,751 [INFO] Epoch 14/100 - Val Loss: 0.3727
2025-08-13 13:31:55,354 [INFO] Epoch 15/100 - Val Loss: 0.2729
2025-08-13 13:31:55,746 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:31:55,747 [INFO] Epoch 15/100 - Train Loss: 0.7055, Val Loss: 0.2729, Val macro_f1: 0.9478, Avg Reg Loss: 0.374283
2025-08-13 13:31:58,971 [INFO] Epoch 16/100 - Val Loss: 0.2556
2025-08-13 13:31:59,359 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:32:02,497 [INFO] Epoch 17/100 - Val Loss: 0.1749
2025-08-13 13:32:02,889 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:32:06,104 [INFO] Epoch 18/100 - Val Loss: 0.1994
2025-08-13 13:32:09,705 [INFO] Epoch 19/100 - Val Loss: 0.1625
2025-08-13 13:32:10,089 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:32:13,324 [INFO] Epoch 20/100 - Val Loss: 0.1911
2025-08-13 13:32:13,699 [INFO] Epoch 20/100 - Train Loss: 0.5217, Val Loss: 0.1911, Val macro_f1: 0.9693, Avg Reg Loss: 0.392530
2025-08-13 13:32:17,033 [INFO] Epoch 21/100 - Val Loss: 0.2954
2025-08-13 13:32:20,646 [INFO] Epoch 22/100 - Val Loss: 0.1387
2025-08-13 13:32:21,037 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:32:24,251 [INFO] Epoch 23/100 - Val Loss: 0.1228
2025-08-13 13:32:24,640 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:32:27,877 [INFO] Epoch 24/100 - Val Loss: 0.1602
2025-08-13 13:32:31,366 [INFO] Epoch 25/100 - Val Loss: 0.1438
2025-08-13 13:32:31,710 [INFO] Epoch 25/100 - Train Loss: 0.5296, Val Loss: 0.1438, Val macro_f1: 0.9848, Avg Reg Loss: 0.391334
2025-08-13 13:32:34,948 [INFO] Epoch 26/100 - Val Loss: 0.1271
2025-08-13 13:32:38,530 [INFO] Epoch 27/100 - Val Loss: 0.1218
2025-08-13 13:32:42,119 [INFO] Epoch 28/100 - Val Loss: 0.1236
2025-08-13 13:32:42,499 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:32:45,715 [INFO] Epoch 29/100 - Val Loss: 0.1203
2025-08-13 13:32:49,213 [INFO] Epoch 30/100 - Val Loss: 0.1257
2025-08-13 13:32:49,589 [INFO] Epoch 30/100 - Train Loss: 0.5019, Val Loss: 0.1257, Val macro_f1: 0.9909, Avg Reg Loss: 0.394354
2025-08-13 13:32:52,804 [INFO] Epoch 31/100 - Val Loss: 0.1348
2025-08-13 13:32:56,400 [INFO] Epoch 32/100 - Val Loss: 0.1221
2025-08-13 13:33:00,186 [INFO] Epoch 33/100 - Val Loss: 0.1794
2025-08-13 13:33:03,731 [INFO] Epoch 34/100 - Val Loss: 0.1249
2025-08-13 13:33:07,299 [INFO] Epoch 35/100 - Val Loss: 0.1205
2025-08-13 13:33:07,693 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:33:07,694 [INFO] Epoch 35/100 - Train Loss: 0.5015, Val Loss: 0.1205, Val macro_f1: 0.9932, Avg Reg Loss: 0.394964
2025-08-13 13:33:10,903 [INFO] Epoch 36/100 - Val Loss: 0.1908
2025-08-13 13:33:14,496 [INFO] Epoch 37/100 - Val Loss: 0.1433
2025-08-13 13:33:18,059 [INFO] Epoch 38/100 - Val Loss: 0.1196
2025-08-13 13:33:21,649 [INFO] Epoch 39/100 - Val Loss: 0.1255
2025-08-13 13:33:25,131 [INFO] Epoch 40/100 - Val Loss: 0.1283
2025-08-13 13:33:25,495 [INFO] Epoch 40/100 - Train Loss: 0.5050, Val Loss: 0.1283, Val macro_f1: 0.9919, Avg Reg Loss: 0.394350
2025-08-13 13:33:28,480 [INFO] Epoch 41/100 - Val Loss: 0.1132
2025-08-13 13:33:28,832 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:33:31,723 [INFO] Epoch 42/100 - Val Loss: 0.1153
2025-08-13 13:33:34,900 [INFO] Epoch 43/100 - Val Loss: 0.1272
2025-08-13 13:33:38,151 [INFO] Epoch 44/100 - Val Loss: 0.1214
2025-08-13 13:33:41,635 [INFO] Epoch 45/100 - Val Loss: 0.1116
2025-08-13 13:33:41,947 [INFO] Epoch 45/100 - Train Loss: 0.4954, Val Loss: 0.1116, Val macro_f1: 0.9953, Avg Reg Loss: 0.394946
2025-08-13 13:33:44,671 [INFO] Epoch 46/100 - Val Loss: 0.1116
2025-08-13 13:33:48,029 [INFO] Epoch 47/100 - Val Loss: 0.1191
2025-08-13 13:33:51,613 [INFO] Epoch 48/100 - Val Loss: 0.1113
2025-08-13 13:33:51,978 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:33:55,023 [INFO] Epoch 49/100 - Val Loss: 0.1111
2025-08-13 13:33:55,384 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:33:58,577 [INFO] Epoch 50/100 - Val Loss: 0.1115
2025-08-13 13:33:58,937 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:33:58,938 [INFO] Epoch 50/100 - Train Loss: 0.4936, Val Loss: 0.1115, Val macro_f1: 0.9966, Avg Reg Loss: 0.394756
2025-08-13 13:34:01,954 [INFO] Epoch 51/100 - Val Loss: 0.1116
2025-08-13 13:34:05,450 [INFO] Epoch 52/100 - Val Loss: 0.1127
2025-08-13 13:34:08,996 [INFO] Epoch 53/100 - Val Loss: 0.1119
2025-08-13 13:34:12,543 [INFO] Epoch 54/100 - Val Loss: 0.1121
2025-08-13 13:34:16,025 [INFO] Epoch 55/100 - Val Loss: 0.1125
2025-08-13 13:34:16,333 [INFO] Epoch 55/100 - Train Loss: 0.4933, Val Loss: 0.1125, Val macro_f1: 0.9956, Avg Reg Loss: 0.394600
2025-08-13 13:34:19,557 [INFO] Epoch 56/100 - Val Loss: 0.1122
2025-08-13 13:34:22,977 [INFO] Epoch 57/100 - Val Loss: 0.1132
2025-08-13 13:34:26,503 [INFO] Epoch 58/100 - Val Loss: 0.1133
2025-08-13 13:34:30,146 [INFO] Epoch 59/100 - Val Loss: 0.1147
2025-08-13 13:34:33,538 [INFO] Epoch 60/100 - Val Loss: 0.1131
2025-08-13 13:34:33,904 [INFO] Early stopping at epoch 60
2025-08-13 13:34:34,251 [INFO] Collected test logits and targets
2025-08-13 13:34:34,378 [INFO] Calibration: T=0.5067, Details={'temperature': 0.5066894888877869, 'best_nll': 0.01792597584426403, 'method': 'logspace'}
2025-08-13 13:34:34,409 [INFO] Saved full results to results\paperA_bilstm_hard_1.json
2025-08-13 13:34:39,057 [INFO] Starting training with args: {'model': 'cnn', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 256, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_cnn_hard_1.json'}
2025-08-13 13:34:39,057 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-13 13:34:39,097 [INFO] Using device: cuda
2025-08-13 13:37:21,675 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 13:37:21,885 [INFO] Model: cnn with 3427848 params
2025-08-13 13:37:34,704 [INFO] Epoch 1/100 - Val Loss: 0.4250
2025-08-13 13:37:35,132 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:37:38,499 [INFO] Epoch 2/100 - Val Loss: 0.2569
2025-08-13 13:37:38,872 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:37:42,202 [INFO] Epoch 3/100 - Val Loss: 0.1892
2025-08-13 13:37:42,599 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:37:45,977 [INFO] Epoch 4/100 - Val Loss: 0.1604
2025-08-13 13:37:46,385 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:37:49,629 [INFO] Epoch 5/100 - Val Loss: 0.1425
2025-08-13 13:37:50,011 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:37:50,012 [INFO] Epoch 5/100 - Train Loss: 0.5434, Val Loss: 0.1425, Val macro_f1: 0.9929, Avg Reg Loss: 0.406850
2025-08-13 13:37:53,284 [INFO] Epoch 6/100 - Val Loss: 0.1412
2025-08-13 13:37:56,823 [INFO] Epoch 7/100 - Val Loss: 0.1334
2025-08-13 13:37:57,188 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:38:00,453 [INFO] Epoch 8/100 - Val Loss: 0.1313
2025-08-13 13:38:00,835 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:38:04,194 [INFO] Epoch 9/100 - Val Loss: 0.1279
2025-08-13 13:38:04,576 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:38:07,835 [INFO] Epoch 10/100 - Val Loss: 0.1262
2025-08-13 13:38:08,236 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:38:08,236 [INFO] Epoch 10/100 - Train Loss: 0.5071, Val Loss: 0.1262, Val macro_f1: 0.9963, Avg Reg Loss: 0.400176
2025-08-13 13:38:11,507 [INFO] Epoch 11/100 - Val Loss: 0.1292
2025-08-13 13:38:15,124 [INFO] Epoch 12/100 - Val Loss: 0.1283
2025-08-13 13:38:15,519 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 13:38:19,197 [INFO] Epoch 13/100 - Val Loss: 0.1291
2025-08-13 13:38:24,748 [INFO] Epoch 14/100 - Val Loss: 0.1286
2025-08-13 13:38:28,419 [INFO] Epoch 15/100 - Val Loss: 0.1274
2025-08-13 13:38:28,768 [INFO] Epoch 15/100 - Train Loss: 0.4990, Val Loss: 0.1274, Val macro_f1: 0.9966, Avg Reg Loss: 0.397019
2025-08-13 13:38:32,045 [INFO] Epoch 16/100 - Val Loss: 0.1299
2025-08-13 13:38:35,697 [INFO] Epoch 17/100 - Val Loss: 0.1253
2025-08-13 13:38:39,375 [INFO] Epoch 18/100 - Val Loss: 0.1312
2025-08-13 13:38:43,091 [INFO] Epoch 19/100 - Val Loss: 0.1303
2025-08-13 13:38:46,942 [INFO] Epoch 20/100 - Val Loss: 0.1304
2025-08-13 13:38:47,228 [INFO] Epoch 20/100 - Train Loss: 0.4964, Val Loss: 0.1304, Val macro_f1: 0.9969, Avg Reg Loss: 0.396198
2025-08-13 13:38:50,517 [INFO] Epoch 21/100 - Val Loss: 0.1307
2025-08-13 13:38:54,225 [INFO] Epoch 22/100 - Val Loss: 0.1296
2025-08-13 13:38:54,575 [INFO] Early stopping at epoch 22
2025-08-13 13:38:54,922 [INFO] Collected test logits and targets
2025-08-13 13:38:55,073 [INFO] Calibration: T=0.4180, Details={'temperature': 0.4180396497249603, 'best_nll': 0.01778389886021614, 'method': 'logspace'}
2025-08-13 13:38:55,107 [INFO] Saved full results to results\paperA_cnn_hard_1.json
2025-08-13 14:10:30,443 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_enhanced_hard_1.json'}
2025-08-13 14:10:30,444 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-13 14:10:30,467 [INFO] Using device: cuda
2025-08-13 14:13:41,048 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 14:13:41,169 [INFO] Model: enhanced with 1738120 params
2025-08-13 14:13:51,722 [INFO] Epoch 1/100 - Val Loss: 0.8152
2025-08-13 14:13:52,022 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:13:53,721 [INFO] Epoch 2/100 - Val Loss: 0.7939
2025-08-13 14:13:54,017 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:13:55,771 [INFO] Epoch 3/100 - Val Loss: 0.7924
2025-08-13 14:13:57,964 [INFO] Epoch 4/100 - Val Loss: 0.7855
2025-08-13 14:13:59,900 [INFO] Epoch 5/100 - Val Loss: 0.7999
2025-08-13 14:14:00,179 [INFO] Epoch 5/100 - Train Loss: 1.0080, Val Loss: 0.7999, Val macro_f1: 0.7003, Avg Reg Loss: 0.349517
2025-08-13 14:14:01,854 [INFO] Epoch 6/100 - Val Loss: 0.8280
2025-08-13 14:14:03,875 [INFO] Epoch 7/100 - Val Loss: 0.8661
2025-08-13 14:14:06,075 [INFO] Epoch 8/100 - Val Loss: 0.8981
2025-08-13 14:14:07,975 [INFO] Epoch 9/100 - Val Loss: 0.9286
2025-08-13 14:14:09,830 [INFO] Epoch 10/100 - Val Loss: 0.9492
2025-08-13 14:14:10,107 [INFO] Epoch 10/100 - Train Loss: 0.7250, Val Loss: 0.9492, Val macro_f1: 0.6791, Avg Reg Loss: 0.384400
2025-08-13 14:14:11,786 [INFO] Epoch 11/100 - Val Loss: 0.9971
2025-08-13 14:14:14,006 [INFO] Epoch 12/100 - Val Loss: 1.0009
2025-08-13 14:14:14,291 [INFO] Early stopping at epoch 12
2025-08-13 14:14:14,544 [INFO] Collected test logits and targets
2025-08-13 14:14:14,680 [INFO] Calibration: T=0.9367, Details={'temperature': 0.9366984367370605, 'best_nll': 0.9245303273200989, 'method': 'logspace'}
2025-08-13 14:14:14,719 [INFO] Saved full results to results\paperA_enhanced_hard_1.json
2025-08-13 14:14:19,417 [INFO] Starting training with args: {'model': 'bilstm', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_bilstm_hard_1.json'}
2025-08-13 14:14:19,417 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-13 14:14:19,440 [INFO] Using device: cuda
2025-08-13 14:17:27,404 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 14:17:27,531 [INFO] Model: bilstm with 583688 params
2025-08-13 14:17:39,590 [INFO] Epoch 1/100 - Val Loss: 1.9254
2025-08-13 14:17:39,993 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:17:42,986 [INFO] Epoch 2/100 - Val Loss: 1.3742
2025-08-13 14:17:43,380 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:17:46,404 [INFO] Epoch 3/100 - Val Loss: 1.0724
2025-08-13 14:17:46,789 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:17:49,804 [INFO] Epoch 4/100 - Val Loss: 0.9434
2025-08-13 14:17:50,184 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:17:53,383 [INFO] Epoch 5/100 - Val Loss: 0.9306
2025-08-13 14:17:53,769 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:17:53,770 [INFO] Epoch 5/100 - Train Loss: 1.2873, Val Loss: 0.9306, Val macro_f1: 0.6181, Avg Reg Loss: 0.348763
2025-08-13 14:17:56,798 [INFO] Epoch 6/100 - Val Loss: 0.8960
2025-08-13 14:17:57,173 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:18:00,194 [INFO] Epoch 7/100 - Val Loss: 0.8612
2025-08-13 14:18:03,580 [INFO] Epoch 8/100 - Val Loss: 0.8374
2025-08-13 14:18:03,967 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:18:07,165 [INFO] Epoch 9/100 - Val Loss: 0.9250
2025-08-13 14:18:10,516 [INFO] Epoch 10/100 - Val Loss: 0.8142
2025-08-13 14:18:10,894 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:18:10,895 [INFO] Epoch 10/100 - Train Loss: 1.1814, Val Loss: 0.8142, Val macro_f1: 0.6832, Avg Reg Loss: 0.338149
2025-08-13 14:18:13,850 [INFO] Epoch 11/100 - Val Loss: 0.8028
2025-08-13 14:18:14,232 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:18:17,217 [INFO] Epoch 12/100 - Val Loss: 0.7909
2025-08-13 14:18:17,583 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:18:20,530 [INFO] Epoch 13/100 - Val Loss: 0.7848
2025-08-13 14:18:23,909 [INFO] Epoch 14/100 - Val Loss: 0.7786
2025-08-13 14:18:27,477 [INFO] Epoch 15/100 - Val Loss: 0.8343
2025-08-13 14:18:27,844 [INFO] Epoch 15/100 - Train Loss: 1.1553, Val Loss: 0.8343, Val macro_f1: 0.6778, Avg Reg Loss: 0.343884
2025-08-13 14:18:30,798 [INFO] Epoch 16/100 - Val Loss: 0.9729
2025-08-13 14:18:34,135 [INFO] Epoch 17/100 - Val Loss: 0.9619
2025-08-13 14:18:37,488 [INFO] Epoch 18/100 - Val Loss: 0.8069
2025-08-13 14:18:41,041 [INFO] Epoch 19/100 - Val Loss: 0.7777
2025-08-13 14:18:44,425 [INFO] Epoch 20/100 - Val Loss: 0.7662
2025-08-13 14:18:44,810 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:18:44,810 [INFO] Epoch 20/100 - Train Loss: 1.1089, Val Loss: 0.7662, Val macro_f1: 0.7059, Avg Reg Loss: 0.348384
2025-08-13 14:18:47,766 [INFO] Epoch 21/100 - Val Loss: 0.7693
2025-08-13 14:18:51,107 [INFO] Epoch 22/100 - Val Loss: 0.7636
2025-08-13 14:18:54,481 [INFO] Epoch 23/100 - Val Loss: 0.8218
2025-08-13 14:18:58,047 [INFO] Epoch 24/100 - Val Loss: 1.1724
2025-08-13 14:19:01,382 [INFO] Epoch 25/100 - Val Loss: 1.0449
2025-08-13 14:19:01,757 [INFO] Epoch 25/100 - Train Loss: 1.4294, Val Loss: 1.0449, Val macro_f1: 0.4813, Avg Reg Loss: 0.314111
2025-08-13 14:19:04,773 [INFO] Epoch 26/100 - Val Loss: 0.9497
2025-08-13 14:19:08,122 [INFO] Epoch 27/100 - Val Loss: 0.8392
2025-08-13 14:19:11,663 [INFO] Epoch 28/100 - Val Loss: 0.7905
2025-08-13 14:19:15,034 [INFO] Epoch 29/100 - Val Loss: 0.8997
2025-08-13 14:19:18,386 [INFO] Epoch 30/100 - Val Loss: 0.8011
2025-08-13 14:19:18,773 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:19:18,774 [INFO] Epoch 30/100 - Train Loss: 1.1601, Val Loss: 0.8011, Val macro_f1: 0.7104, Avg Reg Loss: 0.335612
2025-08-13 14:19:21,980 [INFO] Epoch 31/100 - Val Loss: 0.7873
2025-08-13 14:19:25,296 [INFO] Epoch 32/100 - Val Loss: 0.7107
2025-08-13 14:19:25,681 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:19:28,657 [INFO] Epoch 33/100 - Val Loss: 0.8175
2025-08-13 14:19:32,017 [INFO] Epoch 34/100 - Val Loss: 0.8246
2025-08-13 14:19:35,325 [INFO] Epoch 35/100 - Val Loss: 0.6928
2025-08-13 14:19:35,707 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:19:35,708 [INFO] Epoch 35/100 - Train Loss: 1.0549, Val Loss: 0.6928, Val macro_f1: 0.7416, Avg Reg Loss: 0.340289
2025-08-13 14:19:38,696 [INFO] Epoch 36/100 - Val Loss: 0.6915
2025-08-13 14:19:39,081 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:19:42,251 [INFO] Epoch 37/100 - Val Loss: 0.5926
2025-08-13 14:19:42,638 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:19:45,627 [INFO] Epoch 38/100 - Val Loss: 0.5927
2025-08-13 14:19:49,004 [INFO] Epoch 39/100 - Val Loss: 0.7754
2025-08-13 14:19:52,334 [INFO] Epoch 40/100 - Val Loss: 0.5940
2025-08-13 14:19:52,703 [INFO] Epoch 40/100 - Train Loss: 1.0065, Val Loss: 0.5940, Val macro_f1: 0.7982, Avg Reg Loss: 0.340318
2025-08-13 14:19:55,859 [INFO] Epoch 41/100 - Val Loss: 0.5502
2025-08-13 14:19:59,208 [INFO] Epoch 42/100 - Val Loss: 0.6268
2025-08-13 14:20:02,576 [INFO] Epoch 43/100 - Val Loss: 0.5010
2025-08-13 14:20:02,971 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:20:05,945 [INFO] Epoch 44/100 - Val Loss: 0.6171
2025-08-13 14:20:09,448 [INFO] Epoch 45/100 - Val Loss: 0.5893
2025-08-13 14:20:09,807 [INFO] Epoch 45/100 - Train Loss: 1.0004, Val Loss: 0.5893, Val macro_f1: 0.7740, Avg Reg Loss: 0.354594
2025-08-13 14:20:12,783 [INFO] Epoch 46/100 - Val Loss: 0.4489
2025-08-13 14:20:13,176 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:20:16,174 [INFO] Epoch 47/100 - Val Loss: 0.3878
2025-08-13 14:20:16,558 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:20:19,551 [INFO] Epoch 48/100 - Val Loss: 0.3675
2025-08-13 14:20:20,138 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:20:23,101 [INFO] Epoch 49/100 - Val Loss: 0.9131
2025-08-13 14:20:26,479 [INFO] Epoch 50/100 - Val Loss: 0.5926
2025-08-13 14:20:26,817 [INFO] Epoch 50/100 - Train Loss: 1.0811, Val Loss: 0.5926, Val macro_f1: 0.7968, Avg Reg Loss: 0.345409
2025-08-13 14:20:29,712 [INFO] Epoch 51/100 - Val Loss: 0.5554
2025-08-13 14:20:33,262 [INFO] Epoch 52/100 - Val Loss: 0.4909
2025-08-13 14:20:36,570 [INFO] Epoch 53/100 - Val Loss: 0.4010
2025-08-13 14:20:39,921 [INFO] Epoch 54/100 - Val Loss: 0.3082
2025-08-13 14:20:40,312 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:20:43,290 [INFO] Epoch 55/100 - Val Loss: 0.2550
2025-08-13 14:20:43,668 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:20:43,669 [INFO] Epoch 55/100 - Train Loss: 0.6490, Val Loss: 0.2550, Val macro_f1: 0.9541, Avg Reg Loss: 0.387112
2025-08-13 14:20:46,793 [INFO] Epoch 56/100 - Val Loss: 0.5660
2025-08-13 14:20:50,173 [INFO] Epoch 57/100 - Val Loss: 0.2470
2025-08-13 14:20:50,557 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:20:53,534 [INFO] Epoch 58/100 - Val Loss: 0.6608
2025-08-13 14:20:56,837 [INFO] Epoch 59/100 - Val Loss: 0.4896
2025-08-13 14:21:00,164 [INFO] Epoch 60/100 - Val Loss: 0.3273
2025-08-13 14:21:00,536 [INFO] Epoch 60/100 - Train Loss: 0.7493, Val Loss: 0.3273, Val macro_f1: 0.9324, Avg Reg Loss: 0.362739
2025-08-13 14:21:03,528 [INFO] Epoch 61/100 - Val Loss: 0.2370
2025-08-13 14:21:07,063 [INFO] Epoch 62/100 - Val Loss: 1.1236
2025-08-13 14:21:10,429 [INFO] Epoch 63/100 - Val Loss: 0.4980
2025-08-13 14:21:13,809 [INFO] Epoch 64/100 - Val Loss: 0.4908
2025-08-13 14:21:17,192 [INFO] Epoch 65/100 - Val Loss: 0.3579
2025-08-13 14:21:17,770 [INFO] Epoch 65/100 - Train Loss: 0.7539, Val Loss: 0.3579, Val macro_f1: 0.9014, Avg Reg Loss: 0.365438
2025-08-13 14:21:20,766 [INFO] Epoch 66/100 - Val Loss: 0.3198
2025-08-13 14:21:24,105 [INFO] Epoch 67/100 - Val Loss: 0.2111
2025-08-13 14:21:24,487 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:21:27,461 [INFO] Epoch 68/100 - Val Loss: 0.2412
2025-08-13 14:21:30,802 [INFO] Epoch 69/100 - Val Loss: 0.1678
2025-08-13 14:21:31,172 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:21:34,176 [INFO] Epoch 70/100 - Val Loss: 0.1635
2025-08-13 14:21:34,548 [INFO] Epoch 70/100 - Train Loss: 0.5500, Val Loss: 0.1635, Val macro_f1: 0.9836, Avg Reg Loss: 0.389797
2025-08-13 14:21:37,765 [INFO] Epoch 71/100 - Val Loss: 0.1448
2025-08-13 14:21:38,151 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:21:41,174 [INFO] Epoch 72/100 - Val Loss: 0.1578
2025-08-13 14:21:44,555 [INFO] Epoch 73/100 - Val Loss: 0.1768
2025-08-13 14:21:47,855 [INFO] Epoch 74/100 - Val Loss: 0.1530
2025-08-13 14:21:51,436 [INFO] Epoch 75/100 - Val Loss: 0.1319
2025-08-13 14:21:51,821 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:21:51,822 [INFO] Epoch 75/100 - Train Loss: 0.5195, Val Loss: 0.1319, Val macro_f1: 0.9900, Avg Reg Loss: 0.392197
2025-08-13 14:21:54,827 [INFO] Epoch 76/100 - Val Loss: 0.1364
2025-08-13 14:21:58,188 [INFO] Epoch 77/100 - Val Loss: 0.1305
2025-08-13 14:22:01,745 [INFO] Epoch 78/100 - Val Loss: 0.1328
2025-08-13 14:22:05,079 [INFO] Epoch 79/100 - Val Loss: 0.1530
2025-08-13 14:22:08,442 [INFO] Epoch 80/100 - Val Loss: 0.1395
2025-08-13 14:22:08,792 [INFO] Epoch 80/100 - Train Loss: 0.5255, Val Loss: 0.1395, Val macro_f1: 0.9883, Avg Reg Loss: 0.392438
2025-08-13 14:22:11,794 [INFO] Epoch 81/100 - Val Loss: 0.1291
2025-08-13 14:22:12,171 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:22:15,199 [INFO] Epoch 82/100 - Val Loss: 0.1262
2025-08-13 14:22:18,560 [INFO] Epoch 83/100 - Val Loss: 0.1228
2025-08-13 14:22:18,946 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:22:22,094 [INFO] Epoch 84/100 - Val Loss: 0.1211
2025-08-13 14:22:22,479 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:22:25,475 [INFO] Epoch 85/100 - Val Loss: 0.1300
2025-08-13 14:22:25,850 [INFO] Epoch 85/100 - Train Loss: 0.5027, Val Loss: 0.1300, Val macro_f1: 0.9896, Avg Reg Loss: 0.394798
2025-08-13 14:22:28,842 [INFO] Epoch 86/100 - Val Loss: 0.1337
2025-08-13 14:22:32,185 [INFO] Epoch 87/100 - Val Loss: 0.1195
2025-08-13 14:22:32,573 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:22:35,741 [INFO] Epoch 88/100 - Val Loss: 0.1298
2025-08-13 14:22:39,101 [INFO] Epoch 89/100 - Val Loss: 0.1176
2025-08-13 14:22:39,490 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:22:42,497 [INFO] Epoch 90/100 - Val Loss: 0.1397
2025-08-13 14:22:42,872 [INFO] Epoch 90/100 - Train Loss: 0.5060, Val Loss: 0.1397, Val macro_f1: 0.9853, Avg Reg Loss: 0.394844
2025-08-13 14:22:45,878 [INFO] Epoch 91/100 - Val Loss: 0.1479
2025-08-13 14:22:49,443 [INFO] Epoch 92/100 - Val Loss: 0.2694
2025-08-13 14:22:52,794 [INFO] Epoch 93/100 - Val Loss: 0.1396
2025-08-13 14:22:56,147 [INFO] Epoch 94/100 - Val Loss: 0.1219
2025-08-13 14:22:59,528 [INFO] Epoch 95/100 - Val Loss: 0.1417
2025-08-13 14:23:00,084 [INFO] Epoch 95/100 - Train Loss: 0.5077, Val Loss: 0.1417, Val macro_f1: 0.9847, Avg Reg Loss: 0.394739
2025-08-13 14:23:03,003 [INFO] Epoch 96/100 - Val Loss: 0.1256
2025-08-13 14:23:06,353 [INFO] Epoch 97/100 - Val Loss: 0.1204
2025-08-13 14:23:09,709 [INFO] Epoch 98/100 - Val Loss: 0.1177
2025-08-13 14:23:13,243 [INFO] Epoch 99/100 - Val Loss: 0.1186
2025-08-13 14:23:13,613 [INFO] Early stopping at epoch 99
2025-08-13 14:23:13,983 [INFO] Collected test logits and targets
2025-08-13 14:23:14,150 [INFO] Calibration: T=0.4782, Details={'temperature': 0.47824981808662415, 'best_nll': 0.014516402967274189, 'method': 'logspace'}
2025-08-13 14:23:14,185 [INFO] Saved full results to results\paperA_bilstm_hard_1.json
2025-08-13 14:23:18,968 [INFO] Starting training with args: {'model': 'cnn', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_cnn_hard_1.json'}
2025-08-13 14:23:18,968 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-13 14:23:19,008 [INFO] Using device: cuda
2025-08-13 14:26:28,064 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-13 14:26:28,206 [INFO] Model: cnn with 3427848 params
2025-08-13 14:26:40,760 [INFO] Epoch 1/100 - Val Loss: 1.1868
2025-08-13 14:26:41,174 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:26:44,376 [INFO] Epoch 2/100 - Val Loss: 0.5290
2025-08-13 14:26:44,790 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:26:47,971 [INFO] Epoch 3/100 - Val Loss: 0.4210
2025-08-13 14:26:48,387 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:26:51,782 [INFO] Epoch 4/100 - Val Loss: 0.3201
2025-08-13 14:26:52,190 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:26:55,369 [INFO] Epoch 5/100 - Val Loss: 0.2559
2025-08-13 14:26:55,768 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:26:55,769 [INFO] Epoch 5/100 - Train Loss: 0.6932, Val Loss: 0.2559, Val macro_f1: 0.9607, Avg Reg Loss: 0.418250
2025-08-13 14:26:58,989 [INFO] Epoch 6/100 - Val Loss: 0.2201
2025-08-13 14:26:59,397 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:27:02,585 [INFO] Epoch 7/100 - Val Loss: 0.2088
2025-08-13 14:27:02,988 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:27:06,398 [INFO] Epoch 8/100 - Val Loss: 0.1994
2025-08-13 14:27:06,815 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:27:10,008 [INFO] Epoch 9/100 - Val Loss: 0.1708
2025-08-13 14:27:10,415 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:27:13,603 [INFO] Epoch 10/100 - Val Loss: 0.1675
2025-08-13 14:27:13,999 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:27:14,000 [INFO] Epoch 10/100 - Train Loss: 0.5528, Val Loss: 0.1675, Val macro_f1: 0.9898, Avg Reg Loss: 0.400322
2025-08-13 14:27:17,210 [INFO] Epoch 11/100 - Val Loss: 0.1547
2025-08-13 14:27:20,789 [INFO] Epoch 12/100 - Val Loss: 0.1512
2025-08-13 14:27:21,164 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:27:24,392 [INFO] Epoch 13/100 - Val Loss: 0.1531
2025-08-13 14:27:28,167 [INFO] Epoch 14/100 - Val Loss: 0.1468
2025-08-13 14:27:31,733 [INFO] Epoch 15/100 - Val Loss: 0.1414
2025-08-13 14:27:32,139 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:27:32,140 [INFO] Epoch 15/100 - Train Loss: 0.5255, Val Loss: 0.1414, Val macro_f1: 0.9908, Avg Reg Loss: 0.402223
2025-08-13 14:27:35,361 [INFO] Epoch 16/100 - Val Loss: 0.1396
2025-08-13 14:27:35,782 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:27:39,020 [INFO] Epoch 17/100 - Val Loss: 0.1384
2025-08-13 14:27:39,439 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:27:42,864 [INFO] Epoch 18/100 - Val Loss: 0.1328
2025-08-13 14:27:43,282 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:27:46,500 [INFO] Epoch 19/100 - Val Loss: 0.1360
2025-08-13 14:27:46,919 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:27:50,107 [INFO] Epoch 20/100 - Val Loss: 0.1348
2025-08-13 14:27:50,468 [INFO] Epoch 20/100 - Train Loss: 0.5112, Val Loss: 0.1348, Val macro_f1: 0.9935, Avg Reg Loss: 0.399237
2025-08-13 14:27:53,696 [INFO] Epoch 21/100 - Val Loss: 0.1326
2025-08-13 14:27:57,444 [INFO] Epoch 22/100 - Val Loss: 0.1311
2025-08-13 14:27:57,854 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:28:01,072 [INFO] Epoch 23/100 - Val Loss: 0.1303
2025-08-13 14:28:04,667 [INFO] Epoch 24/100 - Val Loss: 0.1326
2025-08-13 14:28:08,230 [INFO] Epoch 25/100 - Val Loss: 0.1281
2025-08-13 14:28:08,810 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:28:08,811 [INFO] Epoch 25/100 - Train Loss: 0.5061, Val Loss: 0.1281, Val macro_f1: 0.9949, Avg Reg Loss: 0.398653
2025-08-13 14:28:12,031 [INFO] Epoch 26/100 - Val Loss: 0.1279
2025-08-13 14:28:15,596 [INFO] Epoch 27/100 - Val Loss: 0.1262
2025-08-13 14:28:16,009 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:28:19,238 [INFO] Epoch 28/100 - Val Loss: 0.1299
2025-08-13 14:28:22,986 [INFO] Epoch 29/100 - Val Loss: 0.1312
2025-08-13 14:28:26,560 [INFO] Epoch 30/100 - Val Loss: 0.1263
2025-08-13 14:28:26,981 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:28:26,982 [INFO] Epoch 30/100 - Train Loss: 0.5030, Val Loss: 0.1263, Val macro_f1: 0.9949, Avg Reg Loss: 0.398304
2025-08-13 14:28:30,194 [INFO] Epoch 31/100 - Val Loss: 0.1290
2025-08-13 14:28:30,586 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:28:33,797 [INFO] Epoch 32/100 - Val Loss: 0.1318
2025-08-13 14:28:37,571 [INFO] Epoch 33/100 - Val Loss: 0.1262
2025-08-13 14:28:41,146 [INFO] Epoch 34/100 - Val Loss: 0.1263
2025-08-13 14:28:44,725 [INFO] Epoch 35/100 - Val Loss: 0.1325
2025-08-13 14:28:45,086 [INFO] Epoch 35/100 - Train Loss: 0.5001, Val Loss: 0.1325, Val macro_f1: 0.9949, Avg Reg Loss: 0.397562
2025-08-13 14:28:48,311 [INFO] Epoch 36/100 - Val Loss: 0.1273
2025-08-13 14:28:51,876 [INFO] Epoch 37/100 - Val Loss: 0.1292
2025-08-13 14:28:55,438 [INFO] Epoch 38/100 - Val Loss: 0.1283
2025-08-13 14:28:59,216 [INFO] Epoch 39/100 - Val Loss: 0.1273
2025-08-13 14:29:02,800 [INFO] Epoch 40/100 - Val Loss: 0.1289
2025-08-13 14:29:03,204 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-13 14:29:03,204 [INFO] Epoch 40/100 - Train Loss: 0.5001, Val Loss: 0.1289, Val macro_f1: 0.9959, Avg Reg Loss: 0.397867
2025-08-13 14:29:06,425 [INFO] Epoch 41/100 - Val Loss: 0.1295
2025-08-13 14:29:10,028 [INFO] Epoch 42/100 - Val Loss: 0.1321
2025-08-13 14:29:13,720 [INFO] Epoch 43/100 - Val Loss: 0.1285
2025-08-13 14:29:17,302 [INFO] Epoch 44/100 - Val Loss: 0.1258
2025-08-13 14:29:20,883 [INFO] Epoch 45/100 - Val Loss: 0.1293
2025-08-13 14:29:21,241 [INFO] Epoch 45/100 - Train Loss: 0.4981, Val Loss: 0.1293, Val macro_f1: 0.9949, Avg Reg Loss: 0.396873
2025-08-13 14:29:24,463 [INFO] Epoch 46/100 - Val Loss: 0.1278
2025-08-13 14:29:28,045 [INFO] Epoch 47/100 - Val Loss: 0.1283
2025-08-13 14:29:31,820 [INFO] Epoch 48/100 - Val Loss: 0.1266
2025-08-13 14:29:35,396 [INFO] Epoch 49/100 - Val Loss: 0.1272
2025-08-13 14:29:38,970 [INFO] Epoch 50/100 - Val Loss: 0.1269
2025-08-13 14:29:39,328 [INFO] Early stopping at epoch 50
2025-08-13 14:29:39,690 [INFO] Collected test logits and targets
2025-08-13 14:29:39,874 [INFO] Calibration: T=0.4676, Details={'temperature': 0.467607319355011, 'best_nll': 0.023834828287363052, 'method': 'logspace'}
2025-08-13 14:29:39,914 [INFO] Saved full results to results\paperA_cnn_hard_1.json
2025-08-14 17:18:05,452 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_enhanced_hard_1.json'}
2025-08-14 17:18:05,452 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-14 17:18:05,486 [INFO] Using device: cuda
2025-08-14 17:21:03,396 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-14 17:21:03,506 [INFO] Model: enhanced with 61184 params
2025-08-14 17:22:48,105 [INFO] Epoch 1/100 - Val Loss: 3.1120
2025-08-14 17:23:06,819 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:24:51,273 [INFO] Epoch 2/100 - Val Loss: 3.2783
2025-08-14 17:25:09,463 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:26:57,723 [INFO] Epoch 3/100 - Val Loss: 2.1596
2025-08-14 17:27:15,210 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:28:52,360 [INFO] Epoch 4/100 - Val Loss: 0.5972
2025-08-14 17:29:10,609 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:30:46,635 [INFO] Epoch 5/100 - Val Loss: 0.2443
2025-08-14 17:31:04,401 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:31:04,402 [INFO] Epoch 5/100 - Train Loss: 0.6633, Val Loss: 0.2443, Val macro_f1: 0.9765, Avg Reg Loss: 0.432156
2025-08-14 17:32:45,985 [INFO] Epoch 6/100 - Val Loss: 0.1933
2025-08-14 17:33:04,480 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:34:41,997 [INFO] Epoch 7/100 - Val Loss: 0.1425
2025-08-14 17:35:01,582 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:36:42,244 [INFO] Epoch 8/100 - Val Loss: 0.1498
2025-08-14 17:38:44,859 [INFO] Epoch 9/100 - Val Loss: 0.1441
2025-08-14 17:39:03,800 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:40:43,675 [INFO] Epoch 10/100 - Val Loss: 0.1266
2025-08-14 17:41:02,352 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:41:02,352 [INFO] Epoch 10/100 - Train Loss: 0.5326, Val Loss: 0.1266, Val macro_f1: 0.9939, Avg Reg Loss: 0.403918
2025-08-14 17:42:42,287 [INFO] Epoch 11/100 - Val Loss: 0.1214
2025-08-14 17:43:00,659 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:44:36,879 [INFO] Epoch 12/100 - Val Loss: 0.1222
2025-08-14 17:44:54,883 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:46:35,839 [INFO] Epoch 13/100 - Val Loss: 0.1220
2025-08-14 17:48:25,156 [INFO] Epoch 14/100 - Val Loss: 0.1229
2025-08-14 17:50:24,262 [INFO] Epoch 15/100 - Val Loss: 0.1109
2025-08-14 17:50:43,022 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:50:43,024 [INFO] Epoch 15/100 - Train Loss: 0.5146, Val Loss: 0.1109, Val macro_f1: 0.9962, Avg Reg Loss: 0.402650
2025-08-14 17:52:28,308 [INFO] Epoch 16/100 - Val Loss: 0.1099
2025-08-14 17:52:46,781 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:54:30,366 [INFO] Epoch 17/100 - Val Loss: 0.1167
2025-08-14 17:56:24,545 [INFO] Epoch 18/100 - Val Loss: 0.1141
2025-08-14 17:58:24,385 [INFO] Epoch 19/100 - Val Loss: 0.1074
2025-08-14 17:58:41,552 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 17:59:52,775 [INFO] Epoch 20/100 - Val Loss: 0.1058
2025-08-14 18:00:10,741 [INFO] Epoch 20/100 - Train Loss: 0.5076, Val Loss: 0.1058, Val macro_f1: 0.9983, Avg Reg Loss: 0.399883
2025-08-14 18:01:21,749 [INFO] Epoch 21/100 - Val Loss: 0.1049
2025-08-14 18:02:50,136 [INFO] Epoch 22/100 - Val Loss: 0.1061
2025-08-14 18:04:18,337 [INFO] Epoch 23/100 - Val Loss: 0.1076
2025-08-14 18:05:46,504 [INFO] Epoch 24/100 - Val Loss: 0.1100
2025-08-14 18:07:14,271 [INFO] Epoch 25/100 - Val Loss: 0.1020
2025-08-14 18:07:31,087 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 18:07:31,087 [INFO] Epoch 25/100 - Train Loss: 0.5029, Val Loss: 0.1020, Val macro_f1: 0.9990, Avg Reg Loss: 0.397904
2025-08-14 18:08:43,371 [INFO] Epoch 26/100 - Val Loss: 0.1011
2025-08-14 18:10:12,763 [INFO] Epoch 27/100 - Val Loss: 0.1037
2025-08-14 18:11:42,058 [INFO] Epoch 28/100 - Val Loss: 0.1127
2025-08-14 18:13:12,621 [INFO] Epoch 29/100 - Val Loss: 0.1022
2025-08-14 18:14:42,130 [INFO] Epoch 30/100 - Val Loss: 0.1017
2025-08-14 18:14:59,638 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 18:14:59,639 [INFO] Epoch 30/100 - Train Loss: 0.5000, Val Loss: 0.1017, Val macro_f1: 0.9993, Avg Reg Loss: 0.397691
2025-08-14 18:16:12,646 [INFO] Epoch 31/100 - Val Loss: 0.1014
2025-08-14 18:17:40,638 [INFO] Epoch 32/100 - Val Loss: 0.1091
2025-08-14 18:19:09,017 [INFO] Epoch 33/100 - Val Loss: 0.1111
2025-08-14 18:20:37,388 [INFO] Epoch 34/100 - Val Loss: 0.1024
2025-08-14 18:20:54,219 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 18:22:05,156 [INFO] Epoch 35/100 - Val Loss: 0.1067
2025-08-14 18:22:21,973 [INFO] Epoch 35/100 - Train Loss: 0.4984, Val Loss: 0.1067, Val macro_f1: 0.9990, Avg Reg Loss: 0.396905
2025-08-14 18:23:33,922 [INFO] Epoch 36/100 - Val Loss: 0.1034
2025-08-14 18:25:00,974 [INFO] Epoch 37/100 - Val Loss: 0.1115
2025-08-14 18:26:29,101 [INFO] Epoch 38/100 - Val Loss: 0.1079
2025-08-14 18:27:56,475 [INFO] Epoch 39/100 - Val Loss: 0.1011
2025-08-14 18:29:24,696 [INFO] Epoch 40/100 - Val Loss: 0.1014
2025-08-14 18:29:41,459 [INFO] Epoch 40/100 - Train Loss: 0.4972, Val Loss: 0.1014, Val macro_f1: 0.9993, Avg Reg Loss: 0.397185
2025-08-14 18:30:52,091 [INFO] Epoch 41/100 - Val Loss: 0.1013
2025-08-14 18:32:20,363 [INFO] Epoch 42/100 - Val Loss: 0.1144
2025-08-14 18:33:47,757 [INFO] Epoch 43/100 - Val Loss: 0.1038
2025-08-14 18:35:15,927 [INFO] Epoch 44/100 - Val Loss: 0.1021
2025-08-14 18:35:32,744 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 18:36:43,513 [INFO] Epoch 45/100 - Val Loss: 0.1018
2025-08-14 18:37:00,382 [INFO] Epoch 45/100 - Train Loss: 0.4971, Val Loss: 0.1018, Val macro_f1: 0.9990, Avg Reg Loss: 0.396194
2025-08-14 18:38:11,297 [INFO] Epoch 46/100 - Val Loss: 0.1020
2025-08-14 18:39:38,455 [INFO] Epoch 47/100 - Val Loss: 0.1000
2025-08-14 18:41:06,242 [INFO] Epoch 48/100 - Val Loss: 0.1212
2025-08-14 18:42:34,002 [INFO] Epoch 49/100 - Val Loss: 0.1094
2025-08-14 18:44:01,581 [INFO] Epoch 50/100 - Val Loss: 0.0986
2025-08-14 18:44:18,210 [INFO] Epoch 50/100 - Train Loss: 0.4977, Val Loss: 0.0986, Val macro_f1: 0.9990, Avg Reg Loss: 0.396836
2025-08-14 18:45:28,764 [INFO] Epoch 51/100 - Val Loss: 0.1020
2025-08-14 18:46:56,153 [INFO] Epoch 52/100 - Val Loss: 0.1103
2025-08-14 18:48:23,697 [INFO] Epoch 53/100 - Val Loss: 0.1117
2025-08-14 18:49:51,478 [INFO] Epoch 54/100 - Val Loss: 0.1014
2025-08-14 18:50:08,474 [INFO] Early stopping at epoch 54
2025-08-14 18:50:25,261 [INFO] Collected test logits and targets
2025-08-14 18:50:25,452 [INFO] Calibration: T=0.3843, Details={'temperature': 0.38431409001350403, 'best_nll': 0.003135290462523699, 'method': 'logspace'}
2025-08-14 18:50:25,489 [INFO] Saved full results to results\paperA_enhanced_hard_1.json
2025-08-14 18:50:31,826 [INFO] Starting training with args: {'model': 'bilstm', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_bilstm_hard_1.json'}
2025-08-14 18:50:31,826 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-14 18:50:31,858 [INFO] Using device: cuda
2025-08-14 18:53:45,584 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-14 18:53:45,714 [INFO] Model: bilstm with 583688 params
2025-08-14 18:54:26,383 [INFO] Epoch 1/100 - Val Loss: 1.8991
2025-08-14 18:54:41,182 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 18:55:11,738 [INFO] Epoch 2/100 - Val Loss: 1.3549
2025-08-14 18:55:25,976 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 18:55:56,510 [INFO] Epoch 3/100 - Val Loss: 1.1041
2025-08-14 18:56:11,945 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 18:56:43,510 [INFO] Epoch 4/100 - Val Loss: 0.9536
2025-08-14 18:56:57,716 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 18:57:28,477 [INFO] Epoch 5/100 - Val Loss: 0.9304
2025-08-14 18:57:42,728 [INFO] Epoch 5/100 - Train Loss: 1.2792, Val Loss: 0.9304, Val macro_f1: 0.5994, Avg Reg Loss: 0.344222
2025-08-14 18:58:13,291 [INFO] Epoch 6/100 - Val Loss: 0.9121
2025-08-14 18:58:27,316 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 18:58:58,469 [INFO] Epoch 7/100 - Val Loss: 0.8359
2025-08-14 18:59:12,660 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 18:59:43,252 [INFO] Epoch 8/100 - Val Loss: 0.9442
2025-08-14 19:00:28,856 [INFO] Epoch 9/100 - Val Loss: 0.8820
2025-08-14 19:01:14,007 [INFO] Epoch 10/100 - Val Loss: 0.8409
2025-08-14 19:01:28,276 [INFO] Epoch 10/100 - Train Loss: 1.1965, Val Loss: 0.8409, Val macro_f1: 0.6748, Avg Reg Loss: 0.331184
2025-08-14 19:01:59,016 [INFO] Epoch 11/100 - Val Loss: 0.8260
2025-08-14 19:02:44,207 [INFO] Epoch 12/100 - Val Loss: 0.8103
2025-08-14 19:02:58,429 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:03:29,205 [INFO] Epoch 13/100 - Val Loss: 0.9864
2025-08-14 19:04:14,989 [INFO] Epoch 14/100 - Val Loss: 0.8693
2025-08-14 19:04:59,956 [INFO] Epoch 15/100 - Val Loss: 0.7979
2025-08-14 19:05:14,143 [INFO] Epoch 15/100 - Train Loss: 1.1499, Val Loss: 0.7979, Val macro_f1: 0.6802, Avg Reg Loss: 0.337863
2025-08-14 19:05:45,126 [INFO] Epoch 16/100 - Val Loss: 0.7932
2025-08-14 19:05:59,113 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:06:30,363 [INFO] Epoch 17/100 - Val Loss: 0.8480
2025-08-14 19:07:15,127 [INFO] Epoch 18/100 - Val Loss: 0.8049
2025-08-14 19:08:00,531 [INFO] Epoch 19/100 - Val Loss: 0.7775
2025-08-14 19:08:15,518 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:08:46,140 [INFO] Epoch 20/100 - Val Loss: 0.7697
2025-08-14 19:09:00,310 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:09:00,311 [INFO] Epoch 20/100 - Train Loss: 1.1176, Val Loss: 0.7697, Val macro_f1: 0.6987, Avg Reg Loss: 0.344300
2025-08-14 19:09:30,904 [INFO] Epoch 21/100 - Val Loss: 0.7698
2025-08-14 19:10:15,730 [INFO] Epoch 22/100 - Val Loss: 0.7782
2025-08-14 19:10:29,887 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:11:01,055 [INFO] Epoch 23/100 - Val Loss: 0.7665
2025-08-14 19:11:46,657 [INFO] Epoch 24/100 - Val Loss: 1.0150
2025-08-14 19:12:31,468 [INFO] Epoch 25/100 - Val Loss: 1.2188
2025-08-14 19:12:45,834 [INFO] Epoch 25/100 - Train Loss: 1.3539, Val Loss: 1.2188, Val macro_f1: 0.4536, Avg Reg Loss: 0.338962
2025-08-14 19:13:16,595 [INFO] Epoch 26/100 - Val Loss: 0.9253
2025-08-14 19:14:01,470 [INFO] Epoch 27/100 - Val Loss: 0.8500
2025-08-14 19:14:46,225 [INFO] Epoch 28/100 - Val Loss: 0.8197
2025-08-14 19:15:32,354 [INFO] Epoch 29/100 - Val Loss: 0.7831
2025-08-14 19:16:17,384 [INFO] Epoch 30/100 - Val Loss: 0.7592
2025-08-14 19:16:31,599 [INFO] Epoch 30/100 - Train Loss: 1.1059, Val Loss: 0.7592, Val macro_f1: 0.7037, Avg Reg Loss: 0.348356
2025-08-14 19:17:02,203 [INFO] Epoch 31/100 - Val Loss: 0.9836
2025-08-14 19:17:47,744 [INFO] Epoch 32/100 - Val Loss: 0.8110
2025-08-14 19:18:02,017 [INFO] Early stopping at epoch 32
2025-08-14 19:18:16,120 [INFO] Collected test logits and targets
2025-08-14 19:18:16,207 [INFO] Calibration: T=0.7004, Details={'temperature': 0.7004389762878418, 'best_nll': 0.7378267645835876, 'method': 'logspace'}
2025-08-14 19:18:16,465 [INFO] Saved full results to results\paperA_bilstm_hard_1.json
2025-08-14 19:18:16,466 [INFO] Updated registry: results\registry.csv
2025-08-14 19:18:21,307 [INFO] Starting training with args: {'model': 'cnn', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_cnn_hard_1.json'}
2025-08-14 19:18:21,308 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-14 19:18:21,332 [INFO] Using device: cuda
2025-08-14 19:21:35,741 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-14 19:21:35,891 [INFO] Model: cnn with 3427848 params
2025-08-14 19:22:17,120 [INFO] Epoch 1/100 - Val Loss: 1.0827
2025-08-14 19:22:31,624 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:23:02,934 [INFO] Epoch 2/100 - Val Loss: 0.6418
2025-08-14 19:23:17,163 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:23:48,104 [INFO] Epoch 3/100 - Val Loss: 0.4714
2025-08-14 19:24:02,381 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:24:33,533 [INFO] Epoch 4/100 - Val Loss: 0.3808
2025-08-14 19:24:48,539 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:25:20,684 [INFO] Epoch 5/100 - Val Loss: 0.2943
2025-08-14 19:25:35,738 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:25:35,739 [INFO] Epoch 5/100 - Train Loss: 0.7385, Val Loss: 0.2943, Val macro_f1: 0.9472, Avg Reg Loss: 0.417344
2025-08-14 19:26:07,517 [INFO] Epoch 6/100 - Val Loss: 0.2462
2025-08-14 19:26:22,556 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:26:54,863 [INFO] Epoch 7/100 - Val Loss: 0.2174
2025-08-14 19:27:09,006 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:27:39,770 [INFO] Epoch 8/100 - Val Loss: 0.2165
2025-08-14 19:28:25,424 [INFO] Epoch 9/100 - Val Loss: 0.1895
2025-08-14 19:28:40,497 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:29:11,974 [INFO] Epoch 10/100 - Val Loss: 0.1869
2025-08-14 19:29:26,977 [INFO] Epoch 10/100 - Train Loss: 0.5694, Val Loss: 0.1869, Val macro_f1: 0.9833, Avg Reg Loss: 0.409369
2025-08-14 19:29:58,156 [INFO] Epoch 11/100 - Val Loss: 0.1674
2025-08-14 19:30:13,875 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:30:44,997 [INFO] Epoch 12/100 - Val Loss: 0.1555
2025-08-14 19:30:59,810 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:31:31,578 [INFO] Epoch 13/100 - Val Loss: 0.1498
2025-08-14 19:31:46,648 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:32:18,552 [INFO] Epoch 14/100 - Val Loss: 0.1533
2025-08-14 19:32:32,813 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:33:03,940 [INFO] Epoch 15/100 - Val Loss: 0.1527
2025-08-14 19:33:19,288 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:33:19,289 [INFO] Epoch 15/100 - Train Loss: 0.5297, Val Loss: 0.1527, Val macro_f1: 0.9932, Avg Reg Loss: 0.402604
2025-08-14 19:33:50,923 [INFO] Epoch 16/100 - Val Loss: 0.1421
2025-08-14 19:34:05,432 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:34:37,155 [INFO] Epoch 17/100 - Val Loss: 0.1356
2025-08-14 19:35:23,301 [INFO] Epoch 18/100 - Val Loss: 0.1392
2025-08-14 19:36:09,318 [INFO] Epoch 19/100 - Val Loss: 0.1366
2025-08-14 19:36:23,787 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:36:56,082 [INFO] Epoch 20/100 - Val Loss: 0.1350
2025-08-14 19:37:11,013 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:37:11,014 [INFO] Epoch 20/100 - Train Loss: 0.5143, Val Loss: 0.1350, Val macro_f1: 0.9939, Avg Reg Loss: 0.400981
2025-08-14 19:37:42,083 [INFO] Epoch 21/100 - Val Loss: 0.1353
2025-08-14 19:38:27,630 [INFO] Epoch 22/100 - Val Loss: 0.1312
2025-08-14 19:39:12,806 [INFO] Epoch 23/100 - Val Loss: 0.1321
2025-08-14 19:39:27,098 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:39:58,246 [INFO] Epoch 24/100 - Val Loss: 0.1315
2025-08-14 19:40:44,176 [INFO] Epoch 25/100 - Val Loss: 0.1294
2025-08-14 19:40:58,370 [INFO] Epoch 25/100 - Train Loss: 0.5073, Val Loss: 0.1294, Val macro_f1: 0.9939, Avg Reg Loss: 0.399231
2025-08-14 19:41:30,008 [INFO] Epoch 26/100 - Val Loss: 0.1321
2025-08-14 19:42:16,217 [INFO] Epoch 27/100 - Val Loss: 0.1279
2025-08-14 19:43:01,737 [INFO] Epoch 28/100 - Val Loss: 0.1294
2025-08-14 19:43:16,835 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:43:48,597 [INFO] Epoch 29/100 - Val Loss: 0.1299
2025-08-14 19:44:33,759 [INFO] Epoch 30/100 - Val Loss: 0.1314
2025-08-14 19:44:47,960 [INFO] Epoch 30/100 - Train Loss: 0.5039, Val Loss: 0.1314, Val macro_f1: 0.9949, Avg Reg Loss: 0.399420
2025-08-14 19:45:18,963 [INFO] Epoch 31/100 - Val Loss: 0.1271
2025-08-14 19:46:05,103 [INFO] Epoch 32/100 - Val Loss: 0.1316
2025-08-14 19:46:19,959 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:46:50,686 [INFO] Epoch 33/100 - Val Loss: 0.1277
2025-08-14 19:47:04,918 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:47:36,101 [INFO] Epoch 34/100 - Val Loss: 0.1280
2025-08-14 19:48:22,528 [INFO] Epoch 35/100 - Val Loss: 0.1244
2025-08-14 19:48:37,522 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:48:37,522 [INFO] Epoch 35/100 - Train Loss: 0.5003, Val Loss: 0.1244, Val macro_f1: 0.9956, Avg Reg Loss: 0.397321
2025-08-14 19:49:09,285 [INFO] Epoch 36/100 - Val Loss: 0.1257
2025-08-14 19:49:23,748 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:49:55,297 [INFO] Epoch 37/100 - Val Loss: 0.1274
2025-08-14 19:50:42,241 [INFO] Epoch 38/100 - Val Loss: 0.1290
2025-08-14 19:51:28,197 [INFO] Epoch 39/100 - Val Loss: 0.1282
2025-08-14 19:51:42,450 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 19:52:13,198 [INFO] Epoch 40/100 - Val Loss: 0.1269
2025-08-14 19:52:27,375 [INFO] Epoch 40/100 - Train Loss: 0.4986, Val Loss: 0.1269, Val macro_f1: 0.9962, Avg Reg Loss: 0.396857
2025-08-14 19:52:58,564 [INFO] Epoch 41/100 - Val Loss: 0.1275
2025-08-14 19:53:43,786 [INFO] Epoch 42/100 - Val Loss: 0.1276
2025-08-14 19:54:30,991 [INFO] Epoch 43/100 - Val Loss: 0.1298
2025-08-14 19:55:17,335 [INFO] Epoch 44/100 - Val Loss: 0.1263
2025-08-14 19:56:03,973 [INFO] Epoch 45/100 - Val Loss: 0.1247
2025-08-14 19:56:19,524 [INFO] Epoch 45/100 - Train Loss: 0.4981, Val Loss: 0.1247, Val macro_f1: 0.9959, Avg Reg Loss: 0.396572
2025-08-14 19:56:50,533 [INFO] Epoch 46/100 - Val Loss: 0.1268
2025-08-14 19:57:37,306 [INFO] Epoch 47/100 - Val Loss: 0.1258
2025-08-14 19:58:22,904 [INFO] Epoch 48/100 - Val Loss: 0.1261
2025-08-14 19:59:10,115 [INFO] Epoch 49/100 - Val Loss: 0.1296
2025-08-14 19:59:25,122 [INFO] Early stopping at epoch 49
2025-08-14 19:59:39,948 [INFO] Collected test logits and targets
2025-08-14 19:59:40,111 [INFO] Calibration: T=0.4480, Details={'temperature': 0.4480102062225342, 'best_nll': 0.02147495560348034, 'method': 'logspace'}
2025-08-14 19:59:40,353 [INFO] Saved full results to results\paperA_cnn_hard_1.json
2025-08-14 19:59:40,354 [INFO] Updated registry: results\registry.csv
2025-08-14 19:59:45,402 [INFO] Starting training with args: {'model': 'conformer_lite', 'difficulty': 'hard', 'seed': 1, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 100, 'batch': 1024, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints\\', 'logit_l2': 0.1, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.6, 'class_overlap': 0.8, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'out_json': 'results\\paperA_conformer_lite_hard_1.json'}
2025-08-14 19:59:45,403 [INFO] Logs saved to: results\train_eval_1_hard.log
2025-08-14 19:59:45,431 [INFO] Using device: cuda
2025-08-14 20:02:58,431 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-14 20:02:58,571 [INFO] Model: conformer_lite with 1721008 params
2025-08-14 20:03:57,991 [INFO] Epoch 1/100 - Val Loss: 3.1804
2025-08-14 20:04:13,665 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 20:05:02,895 [INFO] Epoch 2/100 - Val Loss: 3.4577
2025-08-14 20:05:18,408 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 20:06:07,559 [INFO] Epoch 3/100 - Val Loss: 1.2464
2025-08-14 20:06:22,944 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 20:07:12,310 [INFO] Epoch 4/100 - Val Loss: 0.9410
2025-08-14 20:07:27,986 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 20:08:17,271 [INFO] Epoch 5/100 - Val Loss: 0.2104
2025-08-14 20:08:32,828 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 20:08:32,828 [INFO] Epoch 5/100 - Train Loss: 0.6056, Val Loss: 0.2104, Val macro_f1: 0.9612, Avg Reg Loss: 0.431567
2025-08-14 20:09:22,917 [INFO] Epoch 6/100 - Val Loss: 0.1403
2025-08-14 20:09:38,813 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 20:10:28,282 [INFO] Epoch 7/100 - Val Loss: 0.2217
2025-08-14 20:11:33,175 [INFO] Epoch 8/100 - Val Loss: 0.3589
2025-08-14 20:12:38,390 [INFO] Epoch 9/100 - Val Loss: 0.2137
2025-08-14 20:13:43,129 [INFO] Epoch 10/100 - Val Loss: 0.1409
2025-08-14 20:13:58,883 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 20:13:58,884 [INFO] Epoch 10/100 - Train Loss: 0.5232, Val Loss: 0.1409, Val macro_f1: 0.9782, Avg Reg Loss: 0.402675
2025-08-14 20:14:48,199 [INFO] Epoch 11/100 - Val Loss: 0.1986
2025-08-14 20:15:53,541 [INFO] Epoch 12/100 - Val Loss: 0.0912
2025-08-14 20:16:09,059 [INFO] Best model saved to checkpoints\best_1_hard.pth
2025-08-14 20:16:58,419 [INFO] Epoch 13/100 - Val Loss: 0.3038
2025-08-14 20:18:04,112 [INFO] Epoch 14/100 - Val Loss: 0.0896
2025-08-14 20:19:09,673 [INFO] Epoch 15/100 - Val Loss: 0.1023
2025-08-14 20:19:25,159 [INFO] Epoch 15/100 - Train Loss: 0.5255, Val Loss: 0.1023, Val macro_f1: 0.9895, Avg Reg Loss: 0.399157
2025-08-14 20:20:15,355 [INFO] Epoch 16/100 - Val Loss: 0.4074
2025-08-14 20:21:20,229 [INFO] Epoch 17/100 - Val Loss: 0.1881
2025-08-14 20:22:25,464 [INFO] Epoch 18/100 - Val Loss: 0.1961
2025-08-14 20:23:30,858 [INFO] Epoch 19/100 - Val Loss: 0.1031
2025-08-14 20:24:36,393 [INFO] Epoch 20/100 - Val Loss: 0.1134
2025-08-14 20:24:51,965 [INFO] Epoch 20/100 - Train Loss: 0.5062, Val Loss: 0.1134, Val macro_f1: 0.9902, Avg Reg Loss: 0.399875
2025-08-14 20:25:41,911 [INFO] Epoch 21/100 - Val Loss: 0.1107
2025-08-14 20:26:47,435 [INFO] Epoch 22/100 - Val Loss: 0.1170
2025-08-14 20:27:02,857 [INFO] Early stopping at epoch 22
2025-08-14 20:27:18,546 [INFO] Collected test logits and targets
2025-08-14 20:27:18,688 [INFO] Calibration: T=0.5440, Details={'temperature': 0.5439533591270447, 'best_nll': 0.04086853936314583, 'method': 'logspace'}
2025-08-14 20:27:18,932 [INFO] Saved full results to results\paperA_conformer_lite_hard_1.json
2025-08-14 20:27:18,933 [INFO] Updated registry: results\registry.csv
