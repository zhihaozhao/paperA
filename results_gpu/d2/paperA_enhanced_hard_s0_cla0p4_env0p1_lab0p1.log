2025-08-16 15:23:29,975 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 32, 'num_classes': 8, 'epochs': 100, 'batch': 768, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints/', 'logit_l2': 0.0, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.1, 'gain_drift_std': 0.1, 'class_overlap': 0.4, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.1, 'amp': True, 'save_ckpt': 'final', 'num_workers_override': 0, 'prefetch_factor': 2, 'val_every': 3, 'out_json': 'results_gpu/d2\\paperA_enhanced_hard_s0_cla0p4_env0p1_lab0p1.json'}
2025-08-16 15:23:29,976 [INFO] Logs saved to: results_gpu\d2\paperA_enhanced_hard_s0_cla0p4_env0p1_lab0p1.log
2025-08-16 15:23:30,001 [INFO] Using device: cuda
2025-08-16 15:25:41,147 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-16 15:25:41,148 [INFO] DataLoader: num_workers=0, pin_memory=True
2025-08-16 15:25:41,267 [INFO] Model: enhanced with 640713 params
2025-08-16 15:25:55,947 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:26:04,053 [INFO] Epoch 3/100 - Val Loss: 0.1902
2025-08-16 15:26:04,583 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:26:12,157 [INFO] Epoch 5/100 - Train Loss: 0.0499, Val Loss: nan, Val macro_f1: 0.9221
2025-08-16 15:26:16,406 [INFO] Epoch 6/100 - Val Loss: 0.0725
2025-08-16 15:26:16,948 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:26:28,999 [INFO] Epoch 9/100 - Val Loss: 0.0882
2025-08-16 15:26:33,263 [INFO] Epoch 10/100 - Train Loss: 0.0240, Val Loss: nan, Val macro_f1: 0.9726
2025-08-16 15:26:41,361 [INFO] Epoch 12/100 - Val Loss: 0.0544
2025-08-16 15:26:41,871 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:26:53,979 [INFO] Epoch 15/100 - Val Loss: 0.0499
2025-08-16 15:26:54,519 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:26:54,519 [INFO] Epoch 15/100 - Train Loss: 0.0147, Val Loss: 0.0499, Val macro_f1: 0.9866
2025-08-16 15:27:06,334 [INFO] Epoch 18/100 - Val Loss: 0.0499
2025-08-16 15:27:06,864 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:27:14,375 [INFO] Epoch 20/100 - Train Loss: 0.0156, Val Loss: nan, Val macro_f1: 0.9870
2025-08-16 15:27:18,814 [INFO] Epoch 21/100 - Val Loss: 0.0523
2025-08-16 15:27:31,093 [INFO] Epoch 24/100 - Val Loss: 0.0518
2025-08-16 15:27:31,624 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:27:35,424 [INFO] Epoch 25/100 - Train Loss: 0.0034, Val Loss: nan, Val macro_f1: 0.9883
2025-08-16 15:27:43,658 [INFO] Epoch 27/100 - Val Loss: 0.0615
2025-08-16 15:27:55,951 [INFO] Epoch 30/100 - Val Loss: 0.0951
2025-08-16 15:27:56,458 [INFO] Epoch 30/100 - Train Loss: 0.0102, Val Loss: 0.0951, Val macro_f1: 0.9743
2025-08-16 15:28:08,459 [INFO] Epoch 33/100 - Val Loss: 0.0557
2025-08-16 15:28:12,734 [INFO] Early stopping at epoch 34
2025-08-16 15:28:13,230 [INFO] Collected test logits and targets
2025-08-16 15:28:13,281 [INFO] Calibration: T=1.5765, Details={'temperature': 1.5764801502227783, 'best_nll': 0.03835813328623772, 'method': 'logspace'}
2025-08-16 15:28:13,531 [INFO] Saved full results to results_gpu/d2\paperA_enhanced_hard_s0_cla0p4_env0p1_lab0p1.json
2025-08-16 15:28:13,537 [INFO] Final model saved to checkpoints/final_enhanced_0_hard.pth
2025-08-16 15:28:13,538 [INFO] Updated registry: results\registry.csv
