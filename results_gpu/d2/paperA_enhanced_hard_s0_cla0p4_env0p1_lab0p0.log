2025-08-16 15:10:08,603 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 32, 'num_classes': 8, 'epochs': 100, 'batch': 768, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints/', 'logit_l2': 0.0, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.1, 'gain_drift_std': 0.1, 'class_overlap': 0.4, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.0, 'amp': True, 'save_ckpt': 'final', 'num_workers_override': 0, 'prefetch_factor': 2, 'val_every': 3, 'out_json': 'results_gpu/d2\\paperA_enhanced_hard_s0_cla0p4_env0p1_lab0p0.json'}
2025-08-16 15:10:08,604 [INFO] Logs saved to: results_gpu\d2\paperA_enhanced_hard_s0_cla0p4_env0p1_lab0p0.log
2025-08-16 15:10:08,630 [INFO] Using device: cuda
2025-08-16 15:12:12,759 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-16 15:12:12,760 [INFO] DataLoader: num_workers=0, pin_memory=True
2025-08-16 15:12:12,879 [INFO] Model: enhanced with 640713 params
2025-08-16 15:12:27,321 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:12:35,413 [INFO] Epoch 3/100 - Val Loss: 0.1592
2025-08-16 15:12:35,935 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:12:43,452 [INFO] Epoch 5/100 - Train Loss: 0.0498, Val Loss: nan, Val macro_f1: 0.9426
2025-08-16 15:12:47,691 [INFO] Epoch 6/100 - Val Loss: 0.0817
2025-08-16 15:12:48,217 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:13:00,178 [INFO] Epoch 9/100 - Val Loss: 0.0342
2025-08-16 15:13:00,704 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:13:04,456 [INFO] Epoch 10/100 - Train Loss: 0.0272, Val Loss: nan, Val macro_f1: 0.9875
2025-08-16 15:13:12,440 [INFO] Epoch 12/100 - Val Loss: 0.0401
2025-08-16 15:13:24,880 [INFO] Epoch 15/100 - Val Loss: 0.0400
2025-08-16 15:13:25,374 [INFO] Epoch 15/100 - Train Loss: 0.0085, Val Loss: 0.0400, Val macro_f1: 0.9872
2025-08-16 15:13:37,166 [INFO] Epoch 18/100 - Val Loss: 0.0497
2025-08-16 15:14:20,262 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 32, 'num_classes': 8, 'epochs': 100, 'batch': 768, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints/', 'logit_l2': 0.0, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.1, 'gain_drift_std': 0.1, 'class_overlap': 0.4, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.0, 'amp': True, 'save_ckpt': 'final', 'num_workers_override': 0, 'prefetch_factor': 2, 'val_every': 3, 'out_json': 'results_gpu/d2\\paperA_enhanced_hard_s0_cla0p4_env0p1_lab0p0.json'}
2025-08-16 15:14:20,262 [INFO] Logs saved to: results_gpu\d2\paperA_enhanced_hard_s0_cla0p4_env0p1_lab0p0.log
2025-08-16 15:14:20,307 [INFO] Using device: cuda
2025-08-16 15:16:21,622 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-16 15:16:21,623 [INFO] DataLoader: num_workers=0, pin_memory=True
2025-08-16 15:16:21,732 [INFO] Model: enhanced with 640713 params
2025-08-16 15:16:34,186 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:16:42,311 [INFO] Epoch 3/100 - Val Loss: 0.2382
2025-08-16 15:16:42,843 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:16:50,437 [INFO] Epoch 5/100 - Train Loss: 0.0553, Val Loss: nan, Val macro_f1: 0.9122
2025-08-16 15:16:54,707 [INFO] Epoch 6/100 - Val Loss: 0.0495
2025-08-16 15:16:55,238 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:17:07,320 [INFO] Epoch 9/100 - Val Loss: 0.0349
2025-08-16 15:17:07,865 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:17:11,704 [INFO] Epoch 10/100 - Train Loss: 0.0189, Val Loss: nan, Val macro_f1: 0.9851
2025-08-16 15:17:19,875 [INFO] Epoch 12/100 - Val Loss: 0.0477
2025-08-16 15:17:20,416 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:17:32,547 [INFO] Epoch 15/100 - Val Loss: 0.0323
2025-08-16 15:17:33,085 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:17:33,086 [INFO] Epoch 15/100 - Train Loss: 0.0115, Val Loss: 0.0323, Val macro_f1: 0.9892
2025-08-16 15:17:45,008 [INFO] Epoch 18/100 - Val Loss: 0.0306
2025-08-16 15:17:53,175 [INFO] Epoch 20/100 - Train Loss: 0.0055, Val Loss: nan, Val macro_f1: 0.9892
2025-08-16 15:17:57,672 [INFO] Epoch 21/100 - Val Loss: 0.0269
2025-08-16 15:17:58,207 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:18:10,054 [INFO] Epoch 24/100 - Val Loss: 0.0247
2025-08-16 15:18:10,584 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:18:14,374 [INFO] Epoch 25/100 - Train Loss: 0.0112, Val Loss: nan, Val macro_f1: 0.9932
2025-08-16 15:18:22,610 [INFO] Epoch 27/100 - Val Loss: 0.0188
2025-08-16 15:18:23,142 [INFO] Best model saved to checkpoints/best_enhanced_0_hard.pth
2025-08-16 15:18:34,954 [INFO] Epoch 30/100 - Val Loss: 0.0612
2025-08-16 15:18:35,454 [INFO] Epoch 30/100 - Train Loss: 0.0114, Val Loss: 0.0612, Val macro_f1: 0.9859
2025-08-16 15:18:47,499 [INFO] Epoch 33/100 - Val Loss: 0.0331
2025-08-16 15:18:55,574 [INFO] Epoch 35/100 - Train Loss: 0.0025, Val Loss: nan, Val macro_f1: 0.9932
2025-08-16 15:18:59,821 [INFO] Epoch 36/100 - Val Loss: 0.0400
2025-08-16 15:19:04,108 [INFO] Early stopping at epoch 37
2025-08-16 15:19:04,600 [INFO] Collected test logits and targets
2025-08-16 15:19:04,660 [INFO] Calibration: T=1.9161, Details={'temperature': 1.9160733222961426, 'best_nll': 0.03135433793067932, 'method': 'logspace'}
2025-08-16 15:19:04,945 [INFO] Saved full results to results_gpu/d2\paperA_enhanced_hard_s0_cla0p4_env0p1_lab0p0.json
2025-08-16 15:19:04,951 [INFO] Final model saved to checkpoints/final_enhanced_0_hard.pth
2025-08-16 15:19:04,951 [INFO] Updated registry: results\registry.csv
