2025-08-16 15:32:37,980 [INFO] Starting training with args: {'model': 'enhanced', 'difficulty': 'hard', 'seed': 0, 'F': 52, 'T': 32, 'num_classes': 8, 'epochs': 100, 'batch': 768, 'n_samples': 20000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints/', 'logit_l2': 0.0, 'sc_corr_rho': 0.5, 'env_burst_rate': 0.2, 'gain_drift_std': 0.1, 'class_overlap': 0.4, 'temp_mode': 'logspace', 'temp_min': 1.0, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.05, 'amp': True, 'save_ckpt': 'final', 'num_workers_override': 0, 'prefetch_factor': 2, 'val_every': 3, 'resume_from': '', 'save_last_every': 0, 'strict_load': 'true', 'out_json': 'results_gpu/d2\\paperA_enhanced_hard_s0_cla0p4_env0p2_lab0p05.json'}
2025-08-16 15:32:37,980 [INFO] Logs saved to: results_gpu\d2\paperA_enhanced_hard_s0_cla0p4_env0p2_lab0p05.log
2025-08-16 15:32:38,007 [INFO] Using device: cuda
2025-08-16 15:34:58,255 [INFO] Dataset: Train=14000, Val=3000, Test=3000
2025-08-16 15:34:58,255 [INFO] DataLoader: num_workers=0, pin_memory=True
2025-08-16 15:34:58,378 [INFO] Model: enhanced with 640713 params
2025-08-16 15:35:21,063 [INFO] Epoch 3/100 - Val Loss: 0.3623
2025-08-16 15:35:29,132 [INFO] Epoch 5/100 - Train Loss: 0.0414, Val Loss: nan, Val macro_f1: 0.8576
2025-08-16 15:35:33,435 [INFO] Epoch 6/100 - Val Loss: 0.0471
2025-08-16 15:35:45,936 [INFO] Epoch 9/100 - Val Loss: 0.0274
2025-08-16 15:35:50,225 [INFO] Epoch 10/100 - Train Loss: 0.0069, Val Loss: nan, Val macro_f1: 0.9905
2025-08-16 15:35:58,284 [INFO] Epoch 12/100 - Val Loss: 0.0470
2025-08-16 15:36:10,812 [INFO] Epoch 15/100 - Val Loss: 0.0641
2025-08-16 15:36:11,315 [INFO] Epoch 15/100 - Train Loss: 0.0363, Val Loss: 0.0641, Val macro_f1: 0.9788
2025-08-16 15:36:23,162 [INFO] Epoch 18/100 - Val Loss: 0.0249
2025-08-16 15:36:31,220 [INFO] Epoch 20/100 - Train Loss: 0.0104, Val Loss: nan, Val macro_f1: 0.9923
2025-08-16 15:36:35,738 [INFO] Epoch 21/100 - Val Loss: 0.3148
2025-08-16 15:36:48,089 [INFO] Epoch 24/100 - Val Loss: 0.0205
2025-08-16 15:36:52,370 [INFO] Epoch 25/100 - Train Loss: 0.0044, Val Loss: nan, Val macro_f1: 0.9932
2025-08-16 15:37:00,634 [INFO] Epoch 27/100 - Val Loss: 0.0155
2025-08-16 15:37:12,998 [INFO] Epoch 30/100 - Val Loss: 0.0158
2025-08-16 15:37:13,499 [INFO] Epoch 30/100 - Train Loss: 0.0022, Val Loss: 0.0158, Val macro_f1: 0.9970
2025-08-16 15:37:25,488 [INFO] Epoch 33/100 - Val Loss: 0.0213
2025-08-16 15:37:33,520 [INFO] Epoch 35/100 - Train Loss: 0.0045, Val Loss: nan, Val macro_f1: 0.9970
2025-08-16 15:37:37,813 [INFO] Epoch 36/100 - Val Loss: 0.0204
2025-08-16 15:37:50,386 [INFO] Epoch 39/100 - Val Loss: 0.0128
2025-08-16 15:37:54,675 [INFO] Early stopping at epoch 40
2025-08-16 15:37:55,167 [INFO] Collected test logits and targets
2025-08-16 15:37:55,222 [INFO] Calibration: T=1.7954, Details={'temperature': 1.7954400777816772, 'best_nll': 0.016961801797151566, 'method': 'logspace'}
2025-08-16 15:37:55,480 [INFO] Saved full results to results_gpu/d2\paperA_enhanced_hard_s0_cla0p4_env0p2_lab0p05.json
2025-08-16 15:37:55,489 [INFO] Final model saved to checkpoints/final_enhanced_0_hard.pth
2025-08-16 15:37:55,490 [INFO] Updated registry: results\registry.csv
